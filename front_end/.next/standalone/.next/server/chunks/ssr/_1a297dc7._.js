module.exports=[3130,a=>{"use strict";a.s(["Card",()=>e,"CardContent",()=>h,"CardFooter",()=>i,"CardHeader",()=>f,"CardTitle",()=>g]);var b=a.i(90944),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border border-white/20 bg-white/70 p-6 shadow-[0_20px_70px_-40px_rgba(16,185,129,0.65)] backdrop-blur-md",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("mb-3 flex items-center justify-between gap-4",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h4",{ref:e,className:(0,d.cn)("text-lg font-semibold leading-tight text-emerald-900",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-sm leading-relaxed text-slate-700",a),...c}));h.displayName="CardContent";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("mt-4 flex flex-wrap items-center justify-between gap-3",a),...c}));i.displayName="CardFooter"},54161,a=>{"use strict";a.s(["Badge",()=>f]);var b=a.i(90944),c=a.i(187),d=a.i(97895);let e=(0,c.cva)("inline-flex items-center border rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow",outline:"border-border bg-background text-foreground"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{className:(0,d.cn)(e({variant:c}),a),...f})}},35893,a=>{"use strict";a.s(["default",()=>l]);var b=a.i(90944),c=a.i(72131),d=a.i(75320),e=a.i(64037),f=a.i(40695),g=a.i(5522),h=a.i(50463),i=a.i(3130),j=a.i(54161),k=a.i(53071);function l(){let{show:a}=(0,e.useToast)(),[k,l]=(0,c.useState)(null),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),J=(0,c.useMemo)(()=>{let a=D.trim().toLowerCase();return a?p.filter(b=>b.name.toLowerCase().includes(a)||(b.address??"").toLowerCase().includes(a)||(b.phone??"").toLowerCase().includes(a)):p},[p,D]);(0,c.useMemo)(()=>x[0]||null,[x]);let K=(0,c.useCallback)(async(b,c)=>{c?.silent?u(!0):s(!0),w(null);try{let a=await d.BranchAPI.list(b,{page_size:200});q(a?.items??[])}catch(c){let b=c?.message||"Unable to load branches";w(b),a({variant:"destructive",title:"Failed to load branches",description:b})}finally{s(!1),u(!1)}},[a]),L=(0,c.useCallback)(async b=>{A(!0),C(null);try{let a=await d.PharmaciesAPI.list(b,{page_size:20});y(a?.items??[])}catch(c){let b=c?.message||"Unable to load pharmacies";C(b),a({variant:"destructive",title:"Unable to load pharmacies",description:b})}finally{A(!1)}},[a]);(0,c.useEffect)(()=>{let b=!1;return async function(){try{let a=await d.AuthAPI.me();if(b)return;let c=a?.tenant_id??null;l(c),c&&await Promise.all([K(c),L(c)])}catch(c){if(b)return;a({variant:"destructive",title:"Unable to load owner profile",description:c?.message||"Please sign in again."})}finally{b||o(!0)}}(),()=>{b=!0}},[K,L,a]);let M=async a=>{},N=(0,c.useMemo)(()=>({total:p.length,withPhone:p.filter(a=>(a.phone??"").trim().length>0).length}),[p]),O=r&&!t;return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-4 rounded-2xl border border-slate-200 bg-white p-6 shadow-md lg:flex-row lg:items-center lg:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Branch management"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Organise your pharmacy locations, keep contact information up to date, and control where sales are attributed."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>k&&K(k,{silent:!0}),disabled:!k||t,children:t?"Refreshing...":"Refresh"}),(0,b.jsx)(f.Button,{size:"sm",onClick:()=>I(!0),disabled:!k||z,className:"bg-emerald-700 hover:bg-emerald-800 text-white",children:"New branch"})]})]}),(0,b.jsxs)("section",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsx)(i.Card,{className:"border border-slate-200 bg-white shadow-md",children:(0,b.jsxs)(i.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(i.CardTitle,{className:"text-xs uppercase tracking-wider text-slate-600",children:"Total branches"}),O?(0,b.jsx)(h.Skeleton,{className:"h-7 w-12"}):(0,b.jsx)("div",{className:"text-2xl font-semibold text-slate-900",children:N.total})]})}),(0,b.jsxs)(i.Card,{className:"border border-slate-200 bg-white shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(i.CardTitle,{className:"text-xs uppercase tracking-wider text-slate-600",children:"Contact-ready"}),O?(0,b.jsx)(h.Skeleton,{className:"h-7 w-12"}):(0,b.jsx)("div",{className:"text-2xl font-semibold text-slate-900",children:N.withPhone})]}),(0,b.jsx)(i.CardFooter,{className:"pt-0 text-xs text-slate-500",children:"Branches with a phone number recorded"})]})]}),(0,b.jsx)("section",{children:(0,b.jsxs)(i.Card,{className:"border border-slate-200 bg-white shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(i.CardTitle,{className:"text-slate-900",children:"Branch directory"}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,b.jsx)(g.Input,{placeholder:"Search branch name, address, phone",value:D,onChange:a=>E(a.target.value),className:"w-64 border border-slate-300 bg-white text-sm text-slate-900 placeholder:text-slate-500"})})]}),(0,b.jsx)(i.CardContent,{className:"p-0",children:O?(0,b.jsx)(h.Skeleton,{className:"h-64 w-full"}):v?(0,b.jsx)("div",{className:"p-6 text-sm text-red-600",children:v}):0===J.length?(0,b.jsxs)("div",{className:"space-y-2 p-6 text-sm text-slate-600",children:[(0,b.jsx)("p",{children:"No branches yet. Create a branch to start allocating sales across locations."}),0===x.length&&!z&&(0,b.jsx)("div",{className:"rounded-lg border border-amber-300 bg-amber-50 p-3 text-xs text-amber-800",children:"We couldn't find a pharmacy record for this tenant. Please complete your pharmacy profile (Settings → Pharmacy) before adding branches."})]}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm text-slate-800",children:[(0,b.jsx)("thead",{className:"bg-slate-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Name"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Address"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Phone"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Pharmacy"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white",children:J.map(a=>{let c=x.find(b=>b.id===a.pharmacy_id);return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-3 py-2 font-semibold text-slate-900",children:a.name}),(0,b.jsx)("td",{className:"px-3 py-2 text-slate-600",children:a.address||"—"}),(0,b.jsx)("td",{className:"px-3 py-2 text-slate-600",children:a.phone||"—"}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)(j.Badge,{variant:"outline",className:"border-emerald-300 bg-emerald-50 text-emerald-800",children:c?.name??`#${a.pharmacy_id}`})}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,b.jsx)(f.Button,{variant:"destructive",size:"sm",onClick:()=>M(a),disabled:F===a.id,children:"Delete"})})})]},a.id)})})]})})}),(0,b.jsxs)(i.CardFooter,{className:"justify-between text-xs text-slate-500",children:[(0,b.jsxs)("div",{children:["Showing ",J.length," of ",p.length," branches"]}),(0,b.jsxs)("div",{children:["Tenant: ",k??"—"]})]})]})}),(0,b.jsx)(m,{open:H,onOpenChange:a=>{a?I(!0):I(!1)},tenantId:k??void 0,pharmacies:x,loadingPharmacies:z,disabled:!k||z||0===x.length,onCreated:async()=>k&&K(k,{silent:!0})})]})}function m({open:a,onOpenChange:h,tenantId:i,pharmacies:j,loadingPharmacies:l,disabled:m,onCreated:n}){let{show:o}=(0,e.useToast)(),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&(l||(0===j.length?q(null):q(a=>a??j[0]?.id??null)))},[a,j,l]);let z=()=>{s(""),u(""),w("")},A=async a=>{if(a.preventDefault(),!i)return void o({variant:"destructive",title:"No tenant context",description:"Reload and try again."});if(!p)return void o({variant:"destructive",title:"Select a pharmacy",description:"A primary pharmacy record is required."});if(!r.trim())return void o({variant:"destructive",title:"Branch name required",description:"Please provide a branch name."});y(!0);try{await d.BranchAPI.create(i,{pharmacy_id:p,name:r.trim(),address:t.trim()||void 0,phone:v.trim()||void 0}),o({variant:"success",title:"Branch created",description:r.trim()}),z(),h(!1),n()}catch(a){o({variant:"destructive",title:"Failed to create branch",description:a?.message||"Please try again."})}finally{y(!1)}};return(0,b.jsx)(k.Sheet,{open:a,onOpenChange:a=>{a||z(),h(a)},children:(0,b.jsxs)(k.SheetContent,{side:"right",className:"max-w-md space-y-4 overflow-y-auto",children:[(0,b.jsxs)(k.SheetHeader,{children:[(0,b.jsx)(k.SheetTitle,{children:"Create branch"}),(0,b.jsx)(k.SheetDescription,{children:"Add a new pharmacy location. Branch names appear in POS sales reports and analytics."})]}),(0,b.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Pharmacy"}),(0,b.jsx)("select",{value:p??"",onChange:a=>q(Number(a.target.value)||null),disabled:l||0===j.length,className:"w-full rounded border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm focus:outline-none focus:ring",children:0===j.length?(0,b.jsx)("option",{value:"",children:"No pharmacy found"}):j.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Branch name"}),(0,b.jsx)(g.Input,{value:r,onChange:a=>s(a.target.value),required:!0,placeholder:"e.g. Bole Branch"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Address (optional)"}),(0,b.jsx)(g.Input,{value:t,onChange:a=>u(a.target.value),placeholder:"Street, city"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Phone (optional)"}),(0,b.jsx)(g.Input,{value:v,onChange:a=>w(a.target.value),placeholder:"e.g. +251-911-000000"})]}),(0,b.jsx)(k.SheetFooter,{children:(0,b.jsxs)("div",{className:"flex w-full flex-col gap-2 sm:flex-row sm:justify-between",children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>{z(),h(!1)},children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:x||m,children:x?"Creating...":"Create branch"})]})})]})]})})}}];

//# sourceMappingURL=_1a297dc7._.js.map