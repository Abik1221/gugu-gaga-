module.exports=[39259,a=>{"use strict";a.s(["default",()=>j]);var b=a.i(90944),c=a.i(72131),d=a.i(50944),e=a.i(5522),f=a.i(40695),g=a.i(50463),h=a.i(64037),i=a.i(75320);function j(){let{show:a}=(0,h.useToast)(),j=(0,d.useParams)(),k=Number(j?.threadId),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!1);async function z(a){q(!0);try{let b=await i.ChatAPI.listMessages(a,k);s(b||[]),w(null)}catch(a){w(a.message||"Failed to load messages")}finally{q(!1)}}async function A(){if(l&&t.trim())try{let a=t.trim();u(""),y(!0),await i.ChatAPI.sendStream(l,k,a,a=>{"final"===a.event&&(z(l),y(!1))})}catch(b){y(!1),a({variant:"destructive",title:"Send failed",description:b.message})}}return(0,c.useEffect)(()=>{(async()=>{try{let a=await i.AuthAPI.me(),b=await i.PharmaciesAPI.list(1,100),c=b?.items||[];o(c);let d=a?.tenant_id||(c[0]?.tenant_id??null);d?(m(d),await z(d)):(w("No tenant context"),q(!1))}catch(a){w(a.message||"Failed"),q(!1)}})()},[k]),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h1",{className:"text-xl font-semibold",children:"Business Chat"})}),p?(0,b.jsx)(g.Skeleton,{className:"h-64"}):v?(0,b.jsx)("div",{className:"text-sm text-red-600",children:v}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"border rounded p-3 h-[60vh] overflow-auto bg-white",children:[r.map(a=>(0,b.jsx)("div",{className:`mb-3 ${"user"===a.role?"text-right":"text-left"}`,children:(0,b.jsx)("div",{className:`inline-block max-w-[80%] p-3 rounded-lg whitespace-pre-wrap ${"user"===a.role?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:"assistant"===a.role?(()=>{try{return JSON.parse(a.content).answer||a.content}catch{return a.content}})():a.content})},a.id)),0===r.length&&(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"No messages yet."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Input,{placeholder:"Type your message",value:t,onChange:a=>u(a.target.value),onKeyDown:a=>{"Enter"===a.key&&A()}}),(0,b.jsx)(f.Button,{onClick:A,disabled:!l||!t.trim()||x,children:x?"Sending...":"Send"}),x&&(0,b.jsx)("div",{className:"text-xs text-gray-500 animate-pulse",children:"Assistant is typingâ€¦"})]})]})]})}}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_owner_chat_%5BthreadId%5D_page_tsx_6e32653c._.js.map