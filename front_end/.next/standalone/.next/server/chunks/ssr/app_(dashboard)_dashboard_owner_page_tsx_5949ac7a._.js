module.exports=[91433,a=>{"use strict";a.s(["default",()=>u]);var b=a.i(90944),c=a.i(72131),d=a.i(38246),e=a.i(75320),f=a.i(64037),g=a.i(40695),h=a.i(50463),i=a.i(3130),j=a.i(48662),k=a.i(39622),l=a.i(85811),m=a.i(54419),n=a.i(59854),o=a.i(58042),p=a.i(94222);let q=[{value:"day",label:"24h"},{value:"week",label:"7d"},{value:"month",label:"30d"},{value:"quarter",label:"90d"},{value:"year",label:"12m"}];function r(a){let b=Number(a??0);return`ETB ${b.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})}`}function s({delta:a}){if(null==a||Number.isNaN(a))return null;let c=a>=0;return(0,b.jsxs)("span",{className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold ${c?"bg-emerald-100 text-emerald-800":"bg-red-100 text-red-800"}`,children:[c?"▲":"▼"," ",Math.abs(a).toFixed(1),"%"]})}function t({title:a,description:c}){return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-8 text-center text-sm text-slate-600",children:[(0,b.jsx)("div",{className:"text-base font-semibold text-slate-800",children:a}),(0,b.jsx)("p",{className:"max-w-sm text-xs leading-relaxed text-slate-600",children:c})]})}function u(){let{show:a}=(0,f.useToast)(),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)("month"),[I,J]=(0,c.useState)(12),K=(0,c.useCallback)(async(a,b)=>{B(!0),D(null);try{let c=await e.OwnerAnalyticsAPI.overview(a,{horizon:b?.horizon||G,trendWeeks:b?.trendWeeks||I});F(c)}catch(a){F(null),D(a?.message||"Unable to load analytics data")}finally{B(!1)}},[G,I]);(0,c.useEffect)(()=>{let a=!0;return async function(){z(!0);try{let b=await e.AuthAPI.me();if(!a)return;if(b?.kyc_status!=="approved"){window.location.href="/dashboard/kyc";return}if(b?.subscription_status!=="active"){window.location.href="/dashboard/payment";return}v(b);let c=b?.tenant_id||null;x(c),c&&await K(c)}catch(b){if(!a)return;v(null),x(null),F(null),D(b?.message||"You are not authorised to view this dashboard")}finally{a&&z(!1)}}(),()=>{a=!1}},[K]);let L=async()=>{w&&(await K(w),a({variant:"success",title:"Analytics refreshed",description:"Latest sales and inventory metrics are now visible."}))},M=async a=>{a!==G&&(H(a),w&&await K(w,{horizon:a}))},N=async a=>{a!==I&&(J(a),w&&await K(w,{trendWeeks:a}))},O=(0,c.useMemo)(()=>{let a=E?.totals,b=E?.deltas;return[{label:"Total revenue",value:r(a?.total_revenue),delta:b?.revenue_vs_last_period},{label:"Average ticket",value:r(a?.average_ticket),delta:b?.avg_ticket_vs_last_period},{label:"Units sold",value:(a?.units_sold??0).toLocaleString("en-US"),delta:b?.units_vs_last_period},{label:"Completed sales",value:(a?.sale_count??0).toLocaleString("en-US"),delta:void 0},{label:"Active cashiers",value:(a?.active_cashiers??0).toLocaleString("en-US"),delta:void 0},{label:"Customers on file",value:(a?.total_customers??0).toLocaleString("en-US"),delta:void 0},{label:"Active customers",value:(a?.active_customers??0).toLocaleString("en-US"),delta:void 0},{label:"Upcoming refills (7d)",value:(a?.upcoming_refills??0).toLocaleString("en-US"),delta:void 0}]},[E]),P=(0,c.useMemo)(()=>(E?.staff_activity||[]).slice(0,20),[E]),Q=E?.revenue_trend||[],R=E?.branch_comparison||[],S=E?.staff_productivity||[],T=E?.top_products||[],U=E?.inventory_health||[],V=E?.recent_payments||[],W=y||A,X=(0,c.useMemo)(()=>{if(!u)return"owner";let a=(u.first_name||"").trim();return a||(u.username||u.email||"owner").trim()||"owner"},[u]);return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-4 rounded-2xl border border-slate-200 bg-white p-5 shadow-md lg:flex-row lg:items-center lg:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-black",children:y?"Loading...":`Welcome back, ${X}`}),(0,b.jsx)("p",{className:"max-w-xl text-sm text-slate-900",children:"Monitor revenue, compare branches, and coach your pharmacy team from a single command center."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsx)("div",{className:"flex rounded-full border border-slate-200 bg-white p-1 text-xs shadow-sm",children:q.map(a=>{let c=G===a.value;return(0,b.jsx)("button",{type:"button",onClick:()=>M(a.value),className:`rounded-full px-3 py-1 font-semibold transition ${c?"bg-emerald-700 text-white shadow-lg":"text-slate-800 hover:bg-slate-100"}`,disabled:A,children:a.label},a.value)})}),(0,b.jsxs)("select",{value:I,onChange:a=>N(Number(a.target.value)||12),className:"rounded-full border border-slate-200 bg-white px-3 py-1 text-xs font-semibold text-slate-800 shadow-sm focus-visible:ring-2 focus-visible:ring-emerald-200",disabled:A,children:[(0,b.jsx)("option",{value:4,children:"4 weeks"}),(0,b.jsx)("option",{value:8,children:"8 weeks"}),(0,b.jsx)("option",{value:12,children:"12 weeks"}),(0,b.jsx)("option",{value:24,children:"24 weeks"})]}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",onClick:L,disabled:A||!w,children:"Refresh"}),(0,b.jsx)(d.default,{href:"/dashboard/owner/integrations",children:(0,b.jsx)(g.Button,{variant:"outline",size:"sm",children:"Connect tools"})}),(0,b.jsx)(d.default,{href:"/dashboard/owner/staff/new",children:(0,b.jsx)(g.Button,{size:"sm",className:"bg-emerald-700 hover:bg-emerald-800 text-white shadow-md",children:"Invite staff"})})]})]}),C&&(0,b.jsx)("div",{className:"rounded border border-red-300 bg-red-100 p-3 text-sm text-red-800",children:C}),(0,b.jsx)("section",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 xl:grid-cols-5",children:O.map(a=>(0,b.jsx)(i.Card,{className:"border border-slate-200 bg-white text-black shadow-md transition transform-gpu hover:-translate-y-0.5",children:(0,b.jsxs)(i.CardHeader,{className:"space-y-2",children:[(0,b.jsx)(i.CardTitle,{className:"text-xs uppercase tracking-wider text-slate-900",children:a.label}),W?(0,b.jsx)(h.Skeleton,{className:"h-8 w-24"}):(0,b.jsx)("div",{className:"text-2xl font-semibold text-black",children:a.value}),!W&&(0,b.jsx)(s,{delta:a.delta})]})},a.label))}),(0,b.jsxs)("section",{className:"grid gap-6 lg:grid-cols-5",children:[(0,b.jsxs)(i.Card,{className:"lg:col-span-3 border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Revenue trend"}),(0,b.jsxs)("span",{className:"text-xs font-semibold uppercase tracking-wider text-slate-900",children:[I," week trajectory"]})]}),(0,b.jsx)(i.CardContent,{className:"h-72",children:W?(0,b.jsx)(h.Skeleton,{className:"h-full w-full"}):0===Q.length?(0,b.jsx)(t,{title:"No sales recorded",description:"Capture a sale from the POS to start building your revenue history."}):(0,b.jsx)(j.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(k.AreaChart,{data:Q,margin:{top:10,right:16,bottom:8,left:-4},children:[(0,b.jsx)("defs",{children:(0,b.jsxs)("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,b.jsx)("stop",{offset:"5%",stopColor:"#065f46",stopOpacity:.22}),(0,b.jsx)("stop",{offset:"95%",stopColor:"#065f46",stopOpacity:.06})]})}),(0,b.jsx)(m.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e6eef4"}),(0,b.jsx)(o.XAxis,{dataKey:"period",tickLine:!1,axisLine:!1,fontSize:12}),(0,b.jsx)(p.YAxis,{tickFormatter:a=>`ETB ${a.toLocaleString("en-US",{maximumFractionDigits:0})}`,width:100,axisLine:!1,tickLine:!1,fontSize:12}),(0,b.jsx)(n.Tooltip,{formatter:a=>r(a),labelFormatter:a=>a}),(0,b.jsx)(l.Area,{type:"monotone",dataKey:"revenue",stroke:"#065f46",strokeWidth:2,fill:"url(#trendGradient)"})]})})})]}),(0,b.jsxs)(i.Card,{className:"lg:col-span-2 border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Inventory health"})}),(0,b.jsx)(i.CardContent,{className:"space-y-3",children:W?(0,b.jsx)(h.Skeleton,{className:"h-32"}):0===U.length?(0,b.jsx)(t,{title:"No inventory audits",description:"Sync your inventory lots so owners know which medicines need attention."}):U.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-800",children:a.label}),(0,b.jsx)("span",{className:"text-sm font-semibold text-emerald-700",children:a.count})]},a.label))})]})]}),(0,b.jsxs)("section",{className:"grid gap-6 lg:grid-cols-5",children:[(0,b.jsxs)(i.Card,{className:"lg:col-span-3 border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Branch comparison"}),(0,b.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Revenue, transactions, and units sold"})]}),(0,b.jsx)(i.CardContent,{className:"space-y-2 overflow-x-auto",children:W?(0,b.jsx)(h.Skeleton,{className:"h-32"}):0===R.length?(0,b.jsx)(t,{title:"No branches on record",description:"Add the branch field when creating sales to see how each site performs."}):(0,b.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm text-slate-800",children:[(0,b.jsx)("thead",{className:"bg-white",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Branch"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Revenue"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Sales"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Units sold"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white",children:R.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-3 py-2",children:a.branch||"Unassigned"}),(0,b.jsx)("td",{className:"px-3 py-2 text-emerald-700",children:r(a.revenue)}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.sale_count.toLocaleString("en-US")}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.units_sold.toLocaleString("en-US")})]},a.branch??"_default"))})]})})]}),(0,b.jsxs)(i.Card,{className:"lg:col-span-2 border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Staff productivity"}),(0,b.jsx)(d.default,{href:"/dashboard/owner/staff",className:"text-xs font-semibold text-emerald-700 hover:underline",children:"View staff list"})]}),(0,b.jsx)(i.CardContent,{className:"space-y-2",children:W?(0,b.jsx)(h.Skeleton,{className:"h-32"}):0===S.length?(0,b.jsx)(t,{title:"No staff sales captured",description:"Record a sale from the POS to start ranking your cashiers."}):(0,b.jsx)("ul",{className:"space-y-2",children:S.map(a=>{let c=a.transactions??a.transaction_count??0,d=a.avg_ticket??(c?a.total_sales/c:0);return(0,b.jsxs)("li",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm font-semibold text-slate-800",children:[(0,b.jsx)("span",{children:a.name}),(0,b.jsx)("span",{className:"text-emerald-700",children:r(a.total_sales)})]}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-slate-600",children:[c.toLocaleString("en-US")," sales • ",r(d)," avg ticket"]})]},a.user_id)})})})]})]}),(0,b.jsxs)("section",{className:"grid gap-6 lg:grid-cols-5",children:[(0,b.jsxs)(i.Card,{className:"lg:col-span-3 border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Staff activity"}),(0,b.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Most recent inventory & POS changes"})]}),(0,b.jsx)(i.CardContent,{className:"space-y-3",children:W?(0,b.jsx)(h.Skeleton,{className:"h-40"}):0===P.length?(0,b.jsx)(t,{title:"No recent activity",description:"Inventory updates, POS sales and staff audits will show here."}):(0,b.jsx)("ul",{className:"space-y-2",children:P.map(a=>(0,b.jsxs)("li",{className:"rounded-lg border border-slate-200 bg-white p-3 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-semibold text-slate-800",children:a.action.replace(/_/g," ")}),(0,b.jsx)("span",{className:"text-xs text-slate-600",children:new Date(a.created_at).toLocaleString()})]}),(0,b.jsx)("div",{className:"mt-1 text-xs text-slate-700",children:(()=>{if(a.description)return a.description;if(a.metadata)try{return"string"==typeof a.metadata?a.metadata:JSON.stringify(a.metadata)}catch{return String(a.metadata)}return"No additional details"})()})]},a.id))})})]}),(0,b.jsxs)(i.Card,{className:"lg:col-span-2 border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Recent payment activity"})}),(0,b.jsx)(i.CardContent,{className:"space-y-2",children:W?(0,b.jsx)(h.Skeleton,{className:"h-32"}):0===V.length?(0,b.jsx)(t,{title:"No submissions yet",description:"Payment uploads appear here for the owner’s records."}):(0,b.jsx)("ul",{className:"space-y-2 text-sm text-slate-800",children:V.map(a=>{let c=a.amount_formatted??(null!=a.amount?r(a.amount):"—"),d=a.method??"N/A";return(0,b.jsxs)("li",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-700",children:[(0,b.jsx)("span",{className:"font-semibold uppercase text-slate-800",children:a.status_label||a.status}),(0,b.jsx)("span",{children:a.created_at_formatted||new Date(a.created_at).toLocaleString()})]}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-slate-700",children:[c," • ",d]})]},a.id)})})})]})]}),(0,b.jsx)("section",{className:"space-y-3",children:(0,b.jsxs)(i.Card,{className:"border border-slate-200 bg-white text-black shadow-md",children:[(0,b.jsxs)(i.CardHeader,{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(i.CardTitle,{className:"text-black",children:"Top products"}),(0,b.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Most recent best sellers"})]}),(0,b.jsx)(i.CardContent,{children:W?(0,b.jsx)(h.Skeleton,{className:"h-32"}):0===T.length?(0,b.jsx)(t,{title:"No product insights yet",description:"Run more sales through the POS to see which medicines drive revenue."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm text-slate-800",children:[(0,b.jsx)("thead",{className:"bg-white",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Product"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Revenue"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Sales"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-semibold uppercase tracking-wider text-slate-900",children:"Quantity"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white",children:T.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-3 py-2",children:a.name}),(0,b.jsx)("td",{className:"px-3 py-2 text-emerald-700",children:r(a.revenue)}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.quantity.toLocaleString("en-US")}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.quantity.toLocaleString("en-US")})]},a.name))})]})})})]})})]})}}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_owner_page_tsx_5949ac7a._.js.map