module.exports=[3130,a=>{"use strict";a.s(["Card",()=>e,"CardContent",()=>h,"CardFooter",()=>i,"CardHeader",()=>f,"CardTitle",()=>g]);var b=a.i(90944),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border border-white/20 bg-white/70 p-6 shadow-[0_20px_70px_-40px_rgba(16,185,129,0.65)] backdrop-blur-md",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("mb-3 flex items-center justify-between gap-4",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h4",{ref:e,className:(0,d.cn)("text-lg font-semibold leading-tight text-emerald-900",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-sm leading-relaxed text-slate-700",a),...c}));h.displayName="CardContent";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("mt-4 flex flex-wrap items-center justify-between gap-3",a),...c}));i.displayName="CardFooter"},79502,a=>{"use strict";a.s(["default",()=>k]);var b=a.i(90944),c=a.i(72131),d=a.i(38246),e=a.i(75320),f=a.i(64037),g=a.i(40695),h=a.i(3130),i=a.i(53071),j=a.i(50463);function k(){let{show:a}=(0,f.useToast)(),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null);(0,c.useEffect)(()=>{let b=!0;return(async()=>{try{let a=await e.AuthAPI.me();if(!b)return;let c=a?.tenant_id||null;l(c)}catch(c){if(!b)return;l(null),a({variant:"destructive",title:"Access denied",description:c?.message||"You are not authorised to manage integrations."})}finally{b&&n(!1)}})(),()=>{b=!1}},[a]),(0,c.useEffect)(()=>{let b=!0;return(async()=>{r(!0);try{let a=await e.IntegrationsAPI.listProviders();if(!b)return;p(a)}catch(c){if(!b)return;a({variant:"destructive",title:"Unable to load tools",description:c?.message||"Could not fetch available integrations."})}finally{b&&r(!1)}})(),()=>{b=!1}},[a]),(0,c.useEffect)(()=>{if(!k){t([]),v(!1);return}let b=!0;return(async()=>{v(!0);try{let a=await e.IntegrationsAPI.listConnections(k);if(!b)return;t(a)}catch(c){if(!b)return;a({variant:"destructive",title:"Unable to load connections",description:c?.message||"Could not fetch your linked tools."})}finally{b&&v(!1)}})(),()=>{b=!1}},[k,a]);let E=(0,c.useMemo)(()=>{let a=new Map;return o.forEach(b=>{a.set(b.key,b)}),a},[o]),F=async()=>{if(w&&k){z(!0);try{let b=Array.from(w.selectedResources);await e.IntegrationsAPI.startOAuth(k,w.provider.key,b.length>0?b:void 0),a({variant:"success",title:"Continue in new tab",description:"Complete the provider connection flow and you will be redirected back."})}catch(b){a({variant:"destructive",title:"Unable to start connection",description:b?.message||"Check your credentials and try again."})}finally{z(!1)}}},G=async()=>{if(k){v(!0);try{let a=await e.IntegrationsAPI.listConnections(k);t(a)}catch(b){a({variant:"destructive",title:"Refresh failed",description:b?.message||"Could not update connection list."})}finally{v(!1)}}},H=async b=>{if(k){D(b);try{await e.IntegrationsAPI.disconnect(k,b),a({variant:"success",title:"Connection removed",description:"This tool no longer syncs with your dashboard."}),await G()}catch(b){a({variant:"destructive",title:"Unable to disconnect",description:b?.message||"Please try again."})}finally{D(null)}}},I=async(b,c,d)=>{if(k){B(`${b.id}-${c}-${d}`);try{await e.IntegrationsAPI.triggerSync(k,b.id,c,d);let f="incoming"===d?"Import":"Sync";a({variant:"success",title:`${f} scheduled`,description:`${f} for ${c} has been queued.`}),await G()}catch(b){a({variant:"destructive",title:"Sync failed",description:b?.message||"Could not queue the sync job."})}finally{B(null)}}};return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-4 rounded-2xl border border-slate-200 bg-white p-6 shadow-md lg:flex-row lg:items-center lg:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-semibold text-slate-900",children:"Tool integrations"}),(0,b.jsx)("p",{className:"max-w-2xl text-sm leading-relaxed text-slate-600",children:"Connect your favourite tools to keep inventory, sales, and supplier data perfectly in sync. You stay in controlâ€”connect, import, and disconnect with a single click."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:G,disabled:u||!k,children:"Refresh connections"}),(0,b.jsx)(d.default,{href:"/dashboard/owner",children:(0,b.jsx)(g.Button,{variant:"ghost",children:"Back to owner dashboard"})})]})]}),(0,b.jsxs)("section",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Available tools"})}),m||q?(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((a,c)=>(0,b.jsx)(j.Skeleton,{className:"h-36 rounded-2xl"},c))}):0===o.length?(0,b.jsx)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-6 text-sm text-slate-600",children:"No integrations are available yet. Check back soon!"}):(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:o.map(a=>{let c=a.capability.supports_delta_sync?"Two-way sync available":"Manual import & export";return(0,b.jsxs)(h.Card,{className:"border border-slate-200 bg-white shadow-md",children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{className:"text-xl text-slate-900",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-slate-600 capitalize",children:a.category})]}),(0,b.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wider text-slate-700 font-semibold",children:"Resources"}),(0,b.jsx)("ul",{className:"space-y-1 text-sm text-slate-700",children:a.capability.resources.map(a=>(0,b.jsx)("li",{children:a},a))}),(0,b.jsx)("p",{className:"text-xs text-slate-600",children:c}),(0,b.jsx)(g.Button,{className:"w-full bg-gray-400 hover:bg-gray-500 text-white",disabled:!0,children:"Coming Soon"})]})]},a.key)})})]}),(0,b.jsxs)("section",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Connected tools"})}),u?(0,b.jsx)("div",{className:"space-y-3",children:Array.from({length:3}).map((a,c)=>(0,b.jsx)(j.Skeleton,{className:"h-32 rounded-2xl"},c))}):0===s.length?(0,b.jsx)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-6 text-sm text-slate-600",children:"You have not connected any tools yet. Pick one above to get started."}):(0,b.jsx)("div",{className:"space-y-4",children:s.map(a=>{let c=E.get(a.provider_key),d=c?.capability.resources||[];return(0,b.jsxs)(h.Card,{className:"border border-slate-200 bg-white shadow-md",children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.CardTitle,{className:"text-slate-900",children:a.provider_name}),(0,b.jsxs)("p",{className:"text-sm text-slate-600",children:["Connected as ",a.display_name]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,b.jsxs)("span",{children:["Status: ",(0,b.jsx)("strong",{className:"text-emerald-700",children:a.status})]}),a.updated_at&&(0,b.jsxs)("span",{children:["Updated ",new Date(a.updated_at).toLocaleString()]})]})]}),(0,b.jsxs)(h.CardContent,{className:"space-y-4",children:[0===d.length?(0,b.jsx)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3 text-sm text-slate-600",children:"This provider is connected but no data resources are available yet."}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wider text-slate-700 font-semibold",children:"Sync actions"}),d.map(c=>{let d=`${a.id}-${c}-incoming`,e=`${a.id}-${c}-outgoing`;return(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:c}),(0,b.jsxs)("p",{className:"text-xs text-slate-600",children:["Import data into Zemen or push updates back to ",a.provider_name,"."]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>I(a,c,"incoming"),disabled:A===d,children:A===d?"Importing...":"Import"}),(0,b.jsx)(g.Button,{size:"sm",variant:"ghost",onClick:()=>I(a,c,"outgoing"),disabled:A===e,children:A===e?"Syncing...":"Push updates"})]})]},c)})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(g.Button,{variant:"destructive",onClick:()=>H(a.id),disabled:C===a.id,children:C===a.id?"Disconnecting...":"Disconnect"})})]})]},a.id)})})]}),(0,b.jsx)(i.Sheet,{open:!!w,onOpenChange:a=>!a&&x(null),children:(0,b.jsxs)(i.SheetContent,{className:"space-y-6",children:[(0,b.jsxs)(i.SheetHeader,{children:[(0,b.jsxs)(i.SheetTitle,{children:["Connect ",w?.provider.name]}),(0,b.jsx)(i.SheetDescription,{children:"Choose the data you want to sync into your dashboard. You can always change this later."})]}),w&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"space-y-2",children:w.provider.capability.resources.map(a=>{let c=w.selectedResources.has(a);return(0,b.jsxs)("label",{className:"flex items-center gap-3 rounded-lg border border-slate-200 bg-white p-3 text-sm text-slate-900",children:[(0,b.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 bg-transparent",checked:c,onChange:b=>{var c;return c=b.target.checked,void x(b=>{if(!b)return b;let d=new Set(b.selectedResources);return c?d.add(a):d.delete(a),{...b,selectedResources:d}})}}),(0,b.jsx)("span",{children:a})]},a)})}),!w.provider.requires_oauth&&(0,b.jsx)("div",{className:"rounded-xl border border-white/10 bg-amber-500/10 p-3 text-sm text-amber-100",children:"This provider allows manual API tokens. OAuth is optional."})]}),(0,b.jsxs)(i.SheetFooter,{className:"flex flex-col gap-2 sm:flex-row sm:justify-end",children:[(0,b.jsx)(g.Button,{variant:"ghost",onClick:()=>x(null),disabled:y,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:F,disabled:y||!k,children:y?"Redirecting...":"Continue to provider"})]})]})})]})}}];

//# sourceMappingURL=_d743b45f._.js.map