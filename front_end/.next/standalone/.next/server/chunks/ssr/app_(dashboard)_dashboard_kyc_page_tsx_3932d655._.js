module.exports=[7462,a=>{"use strict";a.s(["default",()=>D],7462);var b=a.i(90944),c=a.i(72131),d=a.i(46271),e=a.i(3130),f=a.i(40695),g=a.i(5522),h=a.i(17171),i=a.i(54161),j=a.i(20005),k=a.i(41710),l=a.i(16201),m=a.i(92e3),n=a.i(4720),o=a.i(67900),p=a.i(63519),q=a.i(24987),r=a.i(11156),s=a.i(70106);let t=(0,s.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var u=a.i(63588);let v=(0,s.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var w=a.i(75320),x=a.i(64037),y=a.i(50944),z=a.i(71987),A=a.i(12899),B=a.i(14727);function C(){let a=(0,y.useRouter)(),{show:c}=(0,x.useToast)();return(0,b.jsxs)(B.Sidebar,{className:"!bg-white border-r border-gray-200",children:[(0,b.jsx)(B.SidebarHeader,{className:"p-6 border-b border-gray-200",children:(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(z.default,{height:80,width:80,src:A.default,alt:"Mesob Logo",className:"rounded-lg shadow-sm"})})}),(0,b.jsx)(B.SidebarContent,{className:"p-4",children:(0,b.jsx)(B.SidebarMenu,{children:(0,b.jsx)(B.SidebarMenuItem,{children:(0,b.jsxs)(B.SidebarMenuButton,{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("access_token"),a.push("/"),c({title:"Success",description:"Signed out successfully",variant:"success"})},className:"text-emerald-600 hover:bg-emerald-50 hover:text-emerald-700 cursor-pointer font-medium",children:[(0,b.jsx)(j.LogOut,{className:"h-4 w-4 text-emerald-600"}),(0,b.jsx)("span",{className:"text-emerald-600",children:"Sign Out"})]})})})})]})}function D(){let a=(0,y.useRouter)(),{show:j}=(0,x.useToast)(),[s,z]=(0,c.useState)(null),[A,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)({pharmacy_name:"",pharmacy_address:"",owner_phone:"",id_number:"",tin_number:"",notes:""}),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(!1);(0,c.useEffect)(()=>{M()},[]);let M=async()=>{try{D(!0);let b=await (0,w.getAuthJSON)("/api/v1/auth/me"),c=b.tenant_id;if(!c)return void j({title:"Error",description:"No tenant ID found",variant:"destructive"});if("approved"===b.kyc_status)return void("active"!==b.subscription_status?a.push("/dashboard/payment"):a.push("/dashboard/owner"));try{let a=await (0,w.getAuthJSON)(`/api/v1/owner/kyc/status?tenant_id=${c}`);z(a),F({pharmacy_name:a.pharmacy_name||"",pharmacy_address:a.pharmacy_address||"",owner_phone:a.owner_phone||"",id_number:a.id_number||"",tin_number:a.pharmacy_license_number||"",notes:a.notes||""}),J(a.license_document_name||a.pharmacy_license_document_path||"")}catch(a){z({status:"not_submitted"})}}catch(a){j({title:"Error",description:"Failed to load user information",variant:"destructive"})}finally{D(!1)}},N=async b=>{if(b.preventDefault(),!I&&!G)return void j({title:"Error",description:"Business license document is required",variant:"destructive"});L(!0);try{let b=(await (0,w.getAuthJSON)("/api/v1/auth/me")).tenant_id,c={pharmacy_name:E.pharmacy_name,pharmacy_address:E.pharmacy_address,owner_phone:E.owner_phone,id_number:E.id_number,pharmacy_license_number:E.tin_number,notes:E.notes},d=await fetch(`${w.API_BASE}/owner/kyc/status?tenant_id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||localStorage.getItem("access_token")}`},body:JSON.stringify(c)});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a.detail||"Failed to update KYC")}j({title:"Success",description:"KYC information updated successfully. Redirecting...",variant:"success"}),setTimeout(()=>a.push("/dashboard/owner"),1500)}catch(a){j({title:"Error",description:a?.message||"Failed to update KYC information",variant:"destructive"})}finally{L(!1)}};return A?(0,b.jsx)("div",{children:(0,b.jsxs)(B.SidebarProvider,{children:[(0,b.jsx)(C,{}),(0,b.jsx)(B.SidebarInset,{className:"bg-neutral-50",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-emerald-200 border-t-emerald-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-800 font-medium",children:"Loading your information..."})]})})})]})}):(0,b.jsx)("div",{children:(0,b.jsxs)(B.SidebarProvider,{children:[(0,b.jsx)(C,{}),(0,b.jsxs)(B.SidebarInset,{className:"bg-neutral-50 min-h-screen",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-r from-emerald-600 to-emerald-700 px-6 py-6 flex items-center gap-4 sticky top-0 z-10 shadow-lg",children:[(0,b.jsx)(B.SidebarTrigger,{className:"text-white"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white",children:"KYC Verification"}),(0,b.jsx)("p",{className:"text-sm text-emerald-100 mt-0.5",children:"Complete your business verification to get started"})]}),(()=>{switch(s?.status){case"pending":return(0,b.jsxs)(i.Badge,{className:"bg-amber-100 text-amber-800 border-0 px-4 py-2 text-sm font-semibold",children:[(0,b.jsx)(k.Clock,{className:"h-4 w-4 mr-2"}),"Pending Review"]});case"approved":return(0,b.jsxs)(i.Badge,{className:"bg-emerald-100 text-emerald-800 border-0 px-4 py-2 text-sm font-semibold",children:[(0,b.jsx)(l.CheckCircle,{className:"h-4 w-4 mr-2"}),"Approved"]});case"rejected":return(0,b.jsxs)(i.Badge,{className:"bg-rose-100 text-rose-800 border-0 px-4 py-2 text-sm font-semibold",children:[(0,b.jsx)(m.AlertCircle,{className:"h-4 w-4 mr-2"}),"Rejected"]});default:return(0,b.jsx)(i.Badge,{className:"bg-gray-100 text-gray-800 border-0 px-4 py-2 text-sm font-semibold",children:"Not Submitted"})}})()]}),(0,b.jsxs)("div",{className:"p-6 max-w-6xl mx-auto space-y-6",children:[s?.status==="rejected"&&s?.admin_notes&&(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-5 bg-rose-50 border-l-4 border-rose-500 rounded-r-xl",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(m.AlertCircle,{className:"h-5 w-5 text-rose-600 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-rose-900 mb-1",children:"Application Rejected"}),(0,b.jsx)("p",{className:"text-sm text-rose-700",children:s.admin_notes})]})]})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:(0,b.jsxs)(e.Card,{className:"border-0 shadow-xl bg-white overflow-hidden",children:[(0,b.jsx)(e.CardHeader,{className:"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white p-6",children:(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-3 text-white",children:[(0,b.jsx)("div",{className:"p-2 bg-white/20 rounded-lg",children:(0,b.jsx)(n.FileText,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-bold text-lg",children:s?.status==="not_submitted"?"Submit Verification Documents":"Update Your Information"}),(0,b.jsx)("div",{className:"text-emerald-50 text-sm font-normal mt-1",children:"Provide accurate information for quick approval"})]})]})}),(0,b.jsx)(e.CardContent,{className:"p-8",children:(0,b.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(o.Building2,{className:"h-4 w-4 text-emerald-600"}),"Business Name ",(0,b.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,b.jsx)(g.Input,{value:E.pharmacy_name,onChange:a=>F(b=>({...b,pharmacy_name:a.target.value})),placeholder:"Enter your registered business name",className:"h-11 rounded-xl border-gray-300 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",required:!0})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.15},className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(p.Phone,{className:"h-4 w-4 text-emerald-600"}),"Phone Number ",(0,b.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,b.jsx)(g.Input,{value:E.owner_phone,onChange:a=>F(b=>({...b,owner_phone:a.target.value})),placeholder:"+251...",className:"h-11 rounded-xl border-gray-300 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",required:!0})]})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(q.MapPin,{className:"h-4 w-4 text-emerald-600"}),"Business Address ",(0,b.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,b.jsx)(g.Input,{value:E.pharmacy_address,onChange:a=>F(b=>({...b,pharmacy_address:a.target.value})),placeholder:"Full business location address",className:"h-11 rounded-xl border-gray-300 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",required:!0})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.25},className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(r.CreditCard,{className:"h-4 w-4 text-emerald-600"}),"National ID Number ",(0,b.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,b.jsx)(g.Input,{value:E.id_number,onChange:a=>F(b=>({...b,id_number:a.target.value})),placeholder:"Government-issued ID",className:"h-11 rounded-xl border-gray-300 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",required:!0})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(t,{className:"h-4 w-4 text-emerald-600"}),"TIN Number ",(0,b.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,b.jsx)(g.Input,{value:E.tin_number,onChange:a=>F(b=>({...b,tin_number:a.target.value})),placeholder:"Tax Identification Number",className:"h-11 rounded-xl border-gray-300 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",required:!0})]})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(u.MessageSquare,{className:"h-4 w-4 text-emerald-600"}),"Additional Notes"]}),(0,b.jsx)(g.Input,{value:E.notes,onChange:a=>F(b=>({...b,notes:a.target.value})),placeholder:"Any additional information (optional)",className:"h-11 rounded-xl border-gray-300 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"space-y-3",children:[(0,b.jsxs)(h.Label,{className:"text-gray-900 font-semibold flex items-center gap-2",children:[(0,b.jsx)(v,{className:"h-4 w-4 text-emerald-600"}),"Business License Document ",(0,b.jsx)("span",{className:"text-rose-500",children:"*"})]}),I&&(0,b.jsxs)("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[(0,b.jsx)("p",{className:"text-sm text-emerald-900 font-semibold mb-1",children:"âœ“ Current Document:"}),(0,b.jsx)("p",{className:"text-xs text-emerald-700 break-all font-mono",children:I})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"file",id:"license-upload",accept:".pdf,.jpg,.jpeg,.png",onChange:a=>H(a.target.files?.[0]||null),className:"hidden"}),(0,b.jsxs)("label",{htmlFor:"license-upload",className:"flex items-center justify-between px-5 py-4 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer transition hover:border-emerald-500 hover:bg-emerald-50 group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${G?"bg-emerald-100":"bg-gray-100 group-hover:bg-emerald-100"}`,children:(0,b.jsx)(n.FileText,{className:`w-6 h-6 ${G?"text-emerald-600":"text-gray-500 group-hover:text-emerald-600"}`})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:G?G.name:I?"Upload new document (optional)":"Click to upload license"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:I?"Leave empty to keep current document":"PDF, JPG, JPEG or PNG (max 10MB)"})]})]}),(0,b.jsx)("div",{className:"px-4 py-2 bg-emerald-600 text-white text-sm font-semibold rounded-lg hover:bg-emerald-700 transition",children:"BROWSE"})]})]})]}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.45},children:(0,b.jsx)(f.Button,{type:"submit",disabled:K,className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white h-12 text-base font-bold rounded-xl shadow-md hover:shadow-lg transition-all",children:K?(0,b.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Processing..."]}):s?.status==="not_submitted"?"Submit KYC Application":"Update KYC Information"})})]})})]})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"p-5 rounded-xl bg-amber-50 border border-amber-200",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(k.Clock,{className:"h-5 w-5 text-amber-600 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold text-amber-900 mb-1",children:"What happens next?"}),(0,b.jsx)("p",{className:"text-sm text-amber-800",children:"After submitting your KYC information, our admin team will review it within 24-48 hours. Once approved, you'll proceed to payment verification and unlock your dashboard."})]})]})})]})]})]})})}}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_kyc_page_tsx_3932d655._.js.map