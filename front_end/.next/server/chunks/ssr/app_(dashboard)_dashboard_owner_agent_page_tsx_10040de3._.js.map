{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/habtamusemagn/Desktop/last/gugu-gaga-/front_end/app/%28dashboard%29/dashboard/owner/agent/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { AuthAPI, ChatAPI } from \"@/utils/api\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useToast } from \"@/components/ui/toast\";\n\ntype ThreadSummary = {\n  id: number;\n  title?: string | null;\n};\n\ntype ChatMessageRecord = {\n  id: number;\n  role: string;\n  content: string;\n};\n\nconst ROLE_LABELS: Record<string, string> = {\n  user: \"You\",\n  owner: \"You\",\n  assistant: \"Assistant\",\n};\n\nconst ROLE_TONE: Record<string, string> = {\n  user: \"bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg shadow-emerald-500/20\",\n  owner: \"bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg shadow-emerald-500/20\",\n  assistant: \"bg-white/90 border border-white/40 text-slate-900 backdrop-blur\",\n};\n\nfunction normalizeThreadTitle(thread: ThreadSummary, index: number): string {\n  const raw = (thread.title || \"\").trim();\n  if (raw) return raw;\n  return `Conversation #${index + 1}`;\n}\n\nfunction parseAssistantPayload(content: string): any | null {\n  if (!content) return null;\n  try {\n    return JSON.parse(content);\n  } catch {\n    if (content.startsWith(\"{\") && content.includes(\"'\")) {\n      try {\n        const sanitized = content.replace(/'/g, '\"');\n        return JSON.parse(sanitized);\n      } catch {\n        return null;\n      }\n    }\n    return null;\n  }\n}\n\nfunction AssistantContent({ payload }: { payload: any }) {\n  if (!payload || typeof payload !== \"object\") {\n    return null;\n  }\n\n  const rows = Array.isArray(payload.rows) ? payload.rows : null;\n  const hasRows = rows && rows.length > 0;\n\n  const remaining = MAX_PROMPT_LENGTH - messageDraft.length;\n  const isOverLimit = remaining < 0;\n\n  return (\n    <div className=\"space-y-3 text-sm\">\n      {payload.intent && (\n        <div className=\"flex items-center gap-2 rounded border border-emerald-100 bg-emerald-50 px-3 py-2 text-emerald-700\">\n          <span className=\"text-xs font-semibold uppercase tracking-wide\">Intent</span>\n          <span className=\"font-medium\">{String(payload.intent)}</span>\n        </div>\n      )}\n      {payload.error && (\n        <div className=\"rounded border border-red-100 bg-red-50 px-3 py-2 text-sm text-red-700\">\n          Unable to run the analysis at the moment. ({String(payload.error)})\n        </div>\n      )}\n      {payload.answer && typeof payload.answer === \"string\" && (\n        <p className=\"whitespace-pre-wrap leading-relaxed text-gray-800\">{payload.answer}</p>\n      )}\n      {hasRows ? (\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200 text-xs\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                {Object.keys(rows![0]).map((key) => (\n                  <th\n                    key={key}\n                    className=\"px-3 py-2 text-left font-semibold uppercase tracking-wide text-gray-500\"\n                  >\n                    {key}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-gray-100 bg-white\">\n              {rows!.map((row, idx) => (\n                <tr key={idx}>\n                  {Object.keys(rows![0]).map((key) => (\n                    <td key={key} className=\"px-3 py-2 text-gray-700\">\n                      {row[key] === null || row[key] === undefined\n                        ? \"—\"\n                        : typeof row[key] === \"number\"\n                        ? row[key].toLocaleString(\"en-US\")\n                        : String(row[key])}\n                    </td>\n                  ))}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      ) : null}\n      {!payload.error && rows && rows.length === 0 && (\n        <div className=\"rounded border border-gray-200 bg-gray-50 px-3 py-2 text-xs text-gray-600\">\n          The query completed but returned no rows.\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function OwnerAgentPage() {\n  const { show } = useToast();\n\n  const [tenantId, setTenantId] = useState<string | null>(null);\n  const [threads, setThreads] = useState<ThreadSummary[]>([]);\n  const [threadsLoading, setThreadsLoading] = useState(false);\n  const [selectedThreadId, setSelectedThreadId] = useState<number | null>(null);\n  const [messages, setMessages] = useState<ChatMessageRecord[]>([]);\n  const [messagesLoading, setMessagesLoading] = useState(false);\n  const [messageDraft, setMessageDraft] = useState(\"\");\n  const [creatingThread, setCreatingThread] = useState(false);\n  const [sending, setSending] = useState(false);\n  const [assistantThinking, setAssistantThinking] = useState(false);\n  const [bootstrapLoading, setBootstrapLoading] = useState(true);\n  const [globalError, setGlobalError] = useState<string | null>(null);\n  const [showHistory, setShowHistory] = useState(false);\n\n  const messagesEndRef = useRef<HTMLDivElement | null>(null);\n\n  const selectedThread = useMemo(\n    () => threads.find((thread) => thread.id === selectedThreadId) || null,\n    [threads, selectedThreadId],\n  );\n\n  const loadThreads = useCallback(\n    async (tid: string): Promise<ThreadSummary[]> => {\n      setThreadsLoading(true);\n      try {\n        const data = await ChatAPI.listThreads(tid);\n        const safe = Array.isArray(data) ? (data as ThreadSummary[]) : [];\n        setThreads(safe);\n        if (safe.length === 0) {\n          setSelectedThreadId(null);\n        }\n        setGlobalError(null);\n        return safe;\n      } catch (error: any) {\n        setThreads([]);\n        setSelectedThreadId(null);\n        setGlobalError(error?.message || \"Unable to load conversations\");\n        return [];\n      } finally {\n        setThreadsLoading(false);\n      }\n    },\n    [],\n  );\n\n  const loadMessages = useCallback(\n    async (tid: string, threadId: number) => {\n      setMessagesLoading(true);\n      try {\n        const data = await ChatAPI.listMessages(tid, threadId);\n        const safe = Array.isArray(data) ? (data as ChatMessageRecord[]) : [];\n        setMessages(safe);\n      } catch (error: any) {\n        show({\n          variant: \"destructive\",\n          title: \"Failed to load thread\",\n          description: error?.message || \"Unable to fetch messages.\",\n        });\n      } finally {\n        setMessagesLoading(false);\n      }\n    },\n    [show],\n  );\n\n  useEffect(() => {\n    let active = true;\n    async function bootstrap() {\n      setBootstrapLoading(true);\n      try {\n        const profile = await AuthAPI.me();\n        if (!active) return;\n        const tid = profile?.tenant_id || null;\n        if (!tid) {\n          setGlobalError(\"You do not have an active tenant to chat against.\");\n          return;\n        }\n        setTenantId(tid);\n        await loadThreads(tid);\n      } catch (error: any) {\n        if (!active) return;\n        setGlobalError(error?.message || \"Unable to load owner profile.\");\n      } finally {\n        if (active) setBootstrapLoading(false);\n      }\n    }\n    bootstrap();\n    return () => {\n      active = false;\n    };\n  }, [loadThreads]);\n\n  useEffect(() => {\n    if (selectedThreadId && !threads.some((thread) => thread.id === selectedThreadId)) {\n      setSelectedThreadId(threads[0]?.id ?? null);\n    } else if (!selectedThreadId && threads.length > 0) {\n      setSelectedThreadId(threads[0].id);\n    }\n  }, [threads, selectedThreadId]);\n\n  useEffect(() => {\n    if (!tenantId || !selectedThreadId) {\n      setMessages([]);\n      return;\n    }\n    loadMessages(tenantId, selectedThreadId);\n  }, [tenantId, selectedThreadId, loadMessages]);\n\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n    }\n  }, [messages, assistantThinking]);\n\n  const handleCreateThread = async () => {\n    if (!tenantId) return;\n    setCreatingThread(true);\n    try {\n      const created = await ChatAPI.createThread(tenantId);\n      await loadThreads(tenantId);\n      if (created?.id) {\n        setSelectedThreadId(created.id);\n      }\n      setMessages([]);\n    } catch (error: any) {\n      show({\n        variant: \"destructive\",\n        title: \"Could not create thread\",\n        description: error?.message || \"Please try again.\",\n      });\n    } finally {\n      setCreatingThread(false);\n    }\n  };\n\n  const MAX_PROMPT_LENGTH = 300;\n  const remaining = MAX_PROMPT_LENGTH - messageDraft.length;\n  const isOverLimit = remaining < 0;\n\n  const handleSendMessage = async () => {\n    if (!tenantId) return;\n    const prompt = messageDraft.trim();\n    if (!prompt) return;\n    if (prompt.length > MAX_PROMPT_LENGTH) {\n      show({\n        variant: \"destructive\",\n        title: \"Prompt too long\",\n        description: `Limit is ${MAX_PROMPT_LENGTH} characters. Please shorten your question.`,\n      });\n      return;\n    }\n    setMessageDraft(\"\");\n    setSending(true);\n    setAssistantThinking(true);\n    try {\n      let threadIdToUse = selectedThreadId;\n      if (!threadIdToUse) {\n        const created = await ChatAPI.createThread(tenantId);\n        const refreshed = await loadThreads(tenantId);\n        threadIdToUse =\n          (created && typeof created.id === \"number\" ? created.id : undefined) ??\n          (refreshed.length > 0 ? refreshed[0].id : undefined);\n        if (threadIdToUse) {\n          setSelectedThreadId(threadIdToUse);\n        }\n      }\n      if (!threadIdToUse) {\n        throw new Error(\"Unable to start a new conversation\");\n      }\n\n      await ChatAPI.sendMessage(tenantId, threadIdToUse, prompt);\n      await loadMessages(tenantId, threadIdToUse);\n      await loadThreads(tenantId);\n    } catch (error: any) {\n      show({\n        variant: \"destructive\",\n        title: \"Message failed\",\n        description: error?.message || \"Unable to send message.\",\n      });\n      setMessageDraft(prompt);\n    } finally {\n      setSending(false);\n      setAssistantThinking(false);\n    }\n  };\n\n  const handleComposerKeyDown = (event: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (event.key === \"Enter\" && !event.shiftKey) {\n      event.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const isLoadingThreads = threadsLoading || bootstrapLoading;\n  const isLoadingMessages = messagesLoading || bootstrapLoading;\n\n  return (\n    <div className=\"space-y-8\">\n      <div className=\"flex flex-col gap-3 rounded-3xl border border-white/15 bg-white/10 p-6 shadow-[0_28px_120px_-60px_rgba(16,185,129,0.75)] backdrop-blur-xl\">\n        <h1 className=\"text-3xl font-semibold leading-tight text-white\">Zemen AI Assistant</h1>\n        <p className=\"max-w-3xl text-sm leading-relaxed text-emerald-100/80\">\n          Ask questions about sales, inventory, and staff performance. The assistant runs read-only\n          analytics on your tenant data and summarises the results for quick insight.\n        </p>\n      </div>\n\n      {globalError && (\n        <div className=\"rounded border border-red-200 bg-red-50 p-3 text-sm text-red-700\">\n          {globalError}\n        </div>\n      )}\n\n      <div className=\"grid gap-6 lg:grid-cols-[320px,1fr]\">\n        <div className=\"flex flex-col gap-5 rounded-3xl border border-white/15 bg-white/10 p-5 shadow-[0_24px_90px_-50px_rgba(14,165,233,0.45)] backdrop-blur-xl\">\n          <div className=\"flex items-center justify-between text-emerald-100/80\">\n            <h2 className=\"text-sm font-semibold uppercase tracking-[0.3em] text-emerald-100\">Conversations</h2>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => setShowHistory((prev) => !prev)}\n              >\n                {showHistory ? \"Hide history\" : \"Show history\"}\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => tenantId && loadThreads(tenantId)}\n                disabled={!tenantId || isLoadingThreads}\n              >\n                Refresh\n              </Button>\n            </div>\n          </div>\n          <div className=\"space-y-3\">\n            <Button onClick={handleCreateThread} disabled={!tenantId || creatingThread}>\n              {creatingThread ? \"Creating…\" : \"Start new conversation\"}\n            </Button>\n          </div>\n          {showHistory ? (\n            <>\n              <div className=\"h-px w-full bg-gray-100\" />\n              {isLoadingThreads ? (\n                <div className=\"space-y-2\">\n                  {Array.from({ length: 5 }).map((_, index) => (\n                    <Skeleton key={index} className=\"h-12 w-full\" />\n                  ))}\n                </div>\n              ) : threads.length === 0 ? (\n                <div className=\"rounded-2xl border border-white/15 bg-white/5 p-4 text-center text-sm text-emerald-100/80\">\n                  No conversations yet. Start a new one to ask the assistant anything about your pharmacy.\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  {threads.map((thread, index) => {\n                    const title = normalizeThreadTitle(thread, index);\n                    const isActive = thread.id === selectedThreadId;\n                    return (\n                      <button\n                        key={thread.id}\n                        type=\"button\"\n                        onClick={() => setSelectedThreadId(thread.id)}\n                        className={`group w-full rounded-2xl border px-3 py-2 text-left text-sm font-medium transition ${\n                          isActive\n                            ? \"border-transparent bg-gradient-to-r from-emerald-500/25 via-teal-500/20 to-sky-500/25 text-white shadow-lg\"\n                            : \"border-white/15 bg-white/5 text-emerald-100/80 hover:border-emerald-200/50 hover:bg-white/10\"\n                        }`}\n                      >\n                        <div className=\"font-semibold text-white/90\">{title}</div>\n                        <div className=\"text-xs uppercase tracking-[0.3em] text-emerald-100/60\">Thread #{thread.id}</div>\n                      </button>\n                    );\n                  })}\n                </div>\n              )}\n            </>\n          ) : (\n            <div className=\"rounded-2xl border border-white/15 bg-white/5 p-4 text-center text-sm text-emerald-100/80\">\n              Tap “Show history” to browse your previous conversations.\n            </div>\n          )}\n        </div>\n\n        <div className=\"flex flex-col gap-5 rounded-3xl border border-white/15 bg-white/10 p-5 shadow-[0_28px_110px_-60px_rgba(16,185,129,0.7)] backdrop-blur-xl\">\n          <div className=\"flex flex-col gap-1\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-sm font-semibold uppercase tracking-[0.3em] text-emerald-100\">\n                {selectedThread ? normalizeThreadTitle(selectedThread, 0) : \"Conversation\"}\n              </h2>\n              <div className=\"flex items-center gap-2\">\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={() => tenantId && selectedThreadId && loadMessages(tenantId, selectedThreadId)}\n                  disabled={!tenantId || !selectedThreadId || isLoadingMessages}\n                >\n                  Refresh\n                </Button>\n              </div>\n            </div>\n            <p className=\"text-xs text-emerald-100/70\">\n              The assistant uses safe, read-only queries. Ask for sales summaries, inventory gaps, or staff\n              performance insights.\n            </p>\n          </div>\n\n          <div className=\"flex-1 overflow-hidden rounded-3xl border border-white/15 bg-white/5\">\n            {isLoadingMessages ? (\n              <div className=\"p-4 space-y-3\">\n                {Array.from({ length: 5 }).map((_, index) => (\n                  <Skeleton key={index} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : !selectedThreadId ? (\n              <div className=\"flex h-full items-center justify-center p-6 text-sm text-emerald-100/70\">\n                Select a conversation to view messages.\n              </div>\n            ) : messages.length === 0 ? (\n              <div className=\"flex h-full items-center justify-center p-6 text-sm text-emerald-100/70\">\n                Ask your first question to begin.\n              </div>\n            ) : (\n              <div className=\"flex h-[55vh] flex-col gap-3 overflow-y-auto p-4 pr-6\">\n                {messages.map((message) => {\n                  const roleClass = ROLE_TONE[message.role] || ROLE_TONE.assistant;\n                  const label = ROLE_LABELS[message.role] || message.role;\n                  const assistantPayload =\n                    message.role === \"assistant\" ? parseAssistantPayload(message.content) : null;\n                  return (\n                    <div\n                      key={message.id}\n                      className={`flex ${\n                        message.role === \"assistant\" ? \"justify-start\" : \"justify-end\"\n                      }`}\n                    >\n                      <div\n                        className={`max-w-xl rounded-2xl px-3 py-2 text-sm shadow ${roleClass}`}\n                      >\n                        <div className=\"mb-1 text-xs font-semibold uppercase tracking-wide opacity-70\">\n                          {label}\n                        </div>\n                        {assistantPayload ? (\n                          <AssistantContent payload={assistantPayload} />\n                        ) : (\n                          <p className=\"whitespace-pre-wrap leading-relaxed\">\n                            {message.content}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  );\n                })}\n                {assistantThinking && (\n                  <div className=\"flex justify-start\">\n                    <div className=\"max-w-xs rounded-2xl border border-white/20 bg-white/80 px-3 py-2 text-sm text-emerald-800 shadow\">\n                      Assistant is analysing your data…\n                    </div>\n                  </div>\n                )}\n                <div ref={messagesEndRef} />\n              </div>\n            )}\n          </div>\n\n          <form\n            className=\"flex flex-col gap-3 rounded-3xl border border-white/15 bg-white/10 p-4 backdrop-blur-xl\"\n          >\n            <div className=\"flex items-center justify-between text-xs font-semibold uppercase tracking-[0.3em] text-emerald-100/80\">\n              <span>Ask a question</span>\n              <span className={`tracking-normal ${isOverLimit ? \"text-red-300\" : \"text-emerald-200\"}`}>\n                {remaining >= 0 ? `${remaining} characters left` : `${Math.abs(remaining)} over limit`}\n              </span>\n            </div>\n            <textarea\n              className=\"min-h-[120px] w-full resize-y rounded-2xl border border-white/15 bg-white/10 p-3 text-sm text-emerald-100/90 shadow-inner backdrop-blur focus:border-emerald-300/60 focus:outline-none focus:ring-2 focus:ring-emerald-200/40\"\n              placeholder=\"e.g. Show me the top selling medicines this week\"\n              value={messageDraft}\n              maxLength={MAX_PROMPT_LENGTH + 100}\n              onChange={(event) => setMessageDraft(event.target.value)}\n              onKeyDown={handleComposerKeyDown}\n            />\n            <Button onClick={handleSendMessage} disabled={!tenantId || !selectedThreadId || sending || isOverLimit}>\n              {sending ? \"Sending…\" : \"Send\"}\n            </Button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}