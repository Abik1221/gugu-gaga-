{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///home/habtamusemagn/Desktop/last/gugu-gaga-/front_end/app/%28dashboard%29/dashboard/payment/page.tsx"],"sourcesContent":["// \"use client\";\n\n// import React, { useEffect, useState } from \"react\";\n// import { useRouter } from \"next/navigation\";\n// import { Button } from \"@/components/ui/button\";\n// import { Input } from \"@/components/ui/input\";\n// import { Skeleton } from \"@/components/ui/skeleton\";\n// import { useToast } from \"@/components/ui/toast\";\n// import { AuthAPI, BillingAPI } from \"@/utils/api\";\n\n// export default function OwnerPaymentPage() {\n//   const router = useRouter();\n//   const { show } = useToast();\n//   const [loading, setLoading] = useState(true);\n//   const [user, setUser] = useState<any>(null);\n//   const [tenantId, setTenantId] = useState<string | null>(null);\n//   const [paymentCode, setPaymentCode] = useState(\"\");\n//   const [submitting, setSubmitting] = useState(false);\n//   const [refreshing, setRefreshing] = useState(false);\n//   const [error, setError] = useState<string | null>(null);\n\n//   useEffect(() => {\n//     let active = true;\n//     (async () => {\n//       setLoading(true);\n//       try {\n//         const me = await AuthAPI.me();\n//         if (!active) return;\n//         setUser(me);\n//         const tenantFromUser = me?.tenant_id ?? null;\n//         setTenantId(tenantFromUser);\n\n//         const kycApproved = me?.kyc_status === \"approved\";\n//         const subscriptionStatus = me?.subscription_status || \"active\";\n//         if (!kycApproved) {\n//           // router.replace(\"/dashboard/kyc\");\n//           // return;\n//         }\n//         if (subscriptionStatus === \"active\") {\n//           router.replace(\"/dashboard/owner\");\n//           return;\n//         }\n\n//         setError(null);\n//       } catch (err: any) {\n//         if (!active) return;\n//         setError(err?.message || \"Failed to load payment page\");\n//       } finally {\n//         if (active) setLoading(false);\n//       }\n//     })();\n//     return () => {\n//       active = false;\n//     };\n//   }, [router]);\n\n//   const handleSubmit = async (e: React.FormEvent) => {\n//     e.preventDefault();\n//     if (!tenantId) return;\n//     const trimmed = paymentCode.trim();\n//     if (trimmed.length < 4) {\n//       show({\n//         variant: \"destructive\",\n//         title: \"Code too short\",\n//         description: \"Payment codes must be at least 4 characters.\",\n//       });\n//       return;\n//     }\n//     setSubmitting(true);\n//     try {\n//       await BillingAPI.submitPaymentCode(tenantId, trimmed);\n//       show({\n//         variant: \"success\",\n//         title: \"Payment submitted\",\n//         description: \"We’ll notify you once the team verifies it.\",\n//       });\n//       setPaymentCode(\"\");\n//       const latest = await AuthAPI.me();\n//       setUser(latest);\n//       if (latest?.subscription_status === \"pending_verification\") {\n//         show({\n//           variant: \"default\",\n//           title: \"Awaiting verification\",\n//           description: \"The admin team is reviewing your payment.\",\n//         });\n//       }\n//       if (latest?.subscription_status === \"active\") {\n//         router.replace(\"/dashboard/owner\");\n//       }\n//     } catch (err: any) {\n//       show({\n//         variant: \"destructive\",\n//         title: \"Submission failed\",\n//         description: err?.message || \"Unable to submit payment code\",\n//       });\n//     } finally {\n//       setSubmitting(false);\n//     }\n//   };\n\n//   const handleRefresh = async () => {\n//     if (!tenantId) return;\n//     setRefreshing(true);\n//     try {\n//       const latest = await AuthAPI.me();\n//       setUser(latest);\n//       if (latest?.kyc_status !== \"approved\") {\n//         router.replace(\"/dashboard/owner/kyc\");\n//         return;\n//       }\n//       const status = latest?.subscription_status || \"active\";\n//       if (status === \"active\") {\n//         router.replace(\"/dashboard/owner\");\n//       }\n//       show({\n//         variant: \"success\",\n//         title: \"Status refreshed\",\n//         description: \"We have the latest update.\",\n//       });\n//     } catch (err: any) {\n//       show({\n//         variant: \"destructive\",\n//         title: \"Refresh failed\",\n//         description: err?.message || \"Unable to refresh status\",\n//       });\n//     } finally {\n//       setRefreshing(false);\n//     }\n//   };\n\n//   if (loading) return <Skeleton className=\"h-64\" />;\n//   if (error) return <div className=\"text-red-600 text-sm\">{error}</div>;\n\n//   const subscriptionStatus = user?.subscription_status || \"awaiting_payment\";\n\n//   const copies: Record<\n//     string,\n//     {\n//       title: string;\n//       description: string;\n//       variant: \"info\" | \"warning\" | \"success\";\n//     }\n//   > = {\n//     awaiting_payment: {\n//       title: \"Subscription payment required\",\n//       description:\n//         \"Your pharmacy has been approved. Please enter the payment code provided by the admin desk so we can activate your tools.\",\n//       variant: \"info\",\n//     },\n//     pending_verification: {\n//       title: \"Payment awaiting verification\",\n//       description:\n//         \"Thanks for submitting your payment code. The admin team is reviewing it now. You’ll be notified as soon as it’s verified.\",\n//       variant: \"success\",\n//     },\n//     payment_rejected: {\n//       title: \"Payment could not be verified\",\n//       description:\n//         \"The last payment submission was rejected. Double-check the receipt and submit a valid payment code to continue.\",\n//       variant: \"warning\",\n//     },\n//   };\n\n//   const copy = copies[subscriptionStatus] || copies.awaiting_payment;\n//   const bannerClasses =\n//     copy.variant === \"warning\"\n//       ? \"border-red-200 bg-red-50 text-red-800\"\n//       : copy.variant === \"success\"\n//       ? \"border-emerald-200 bg-emerald-50 text-emerald-800\"\n//       : \"border-amber-200 bg-amber-50 text-amber-800\";\n\n//   return (\n//     <div className=\"max-w-3xl mx-auto space-y-6\">\n//       <div className=\"space-y-2\">\n//         <h1 className=\"text-2xl font-semibold\">{copy.title}</h1>\n//         <p className=\"text-sm text-muted-foreground\">{copy.description}</p>\n//       </div>\n\n//       <div className={`rounded border p-4 space-y-4 ${bannerClasses}`}>\n//         <div className=\"flex items-center justify-between\">\n//           <div>\n//             <div className=\"text-xs uppercase tracking-wide\">\n//               Current status\n//             </div>\n//             <div className=\"text-lg font-semibold capitalize\">\n//               {subscriptionStatus.replace(/_/g, \" \")}\n//             </div>\n//           </div>\n//           <Button\n//             variant=\"outline\"\n//             onClick={handleRefresh}\n//             disabled={refreshing}\n//           >\n//             {refreshing ? \"Refreshing...\" : \"Refresh status\"}\n//           </Button>\n//         </div>\n\n//         {subscriptionStatus !== \"pending_verification\" && (\n//           <form className=\"space-y-3\" onSubmit={handleSubmit}>\n//             <div className=\"space-y-1\">\n//               <label\n//                 className=\"text-xs uppercase tracking-wide text-muted-foreground\"\n//                 htmlFor=\"payment-code-input\"\n//               >\n//                 Payment code\n//               </label>\n//               <Input\n//                 id=\"payment-code-input\"\n//                 value={paymentCode}\n//                 onChange={(e) => setPaymentCode(e.target.value)}\n//                 placeholder=\"Enter the receipt/payment code\"\n//               />\n//             </div>\n//             <div className=\"flex gap-2\">\n//               <Button type=\"submit\" disabled={submitting}>\n//                 {submitting ? \"Submitting...\" : \"Submit code\"}\n//               </Button>\n//               <Button\n//                 type=\"button\"\n//                 variant=\"outline\"\n//                 onClick={() => setPaymentCode(\"\")}\n//                 disabled={submitting || paymentCode.length === 0}\n//               >\n//                 Clear\n//               </Button>\n//             </div>\n//           </form>\n//         )}\n\n//         {subscriptionStatus === \"pending_verification\" && (\n//           <div className=\"text-sm\">\n//             We will email you once verification is complete. You can refresh\n//             this page to check for updates.\n//           </div>\n//         )}\n//       </div>\n//     </div>\n//   );\n// }\n"],"names":[],"mappings":"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","debugId":null}}]
}