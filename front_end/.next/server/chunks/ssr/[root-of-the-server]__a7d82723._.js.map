{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","turbopack:///[project]/node_modules/next/navigation.js","turbopack:///[project]/components/ui/input.tsx","turbopack:///[project]/components/ui/skeleton.tsx","turbopack:///[project]/app/(dashboard)/dashboard/pos/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","module.exports = require('./dist/client/components/navigation')\n","\"use client\";\nimport * as React from \"react\";\n\nexport interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nexport const Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <input\n        ref={ref}\n        className={\n          \"w-full border rounded px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-200 focus:border-emerald-400 \" +\n          className\n        }\n        {...props}\n      />\n    );\n  }\n);\nInput.displayName = \"Input\";\nexport default Input;\n","\"use client\";\nimport React from \"react\";\n\nexport function Skeleton({ className = \"\" }: { className?: string }) {\n  return <div className={`animate-pulse bg-gray-200 rounded ${className}`} />;\n}\n\nexport function TableSkeletonRows({ rows = 6, cols = 6 }: { rows?: number; cols?: number }) {\n  return (\n    <tbody>\n      {Array.from({ length: rows }).map((_, r) => (\n        <tr key={r} className=\"border-t\">\n          {Array.from({ length: cols }).map((__, c) => (\n            <td key={c} className=\"px-3 py-2\">\n              <Skeleton className=\"h-4 w-full\" />\n            </td>\n          ))}\n        </tr>\n      ))}\n    </tbody>\n  );\n}\n","// POS page\n\"use client\";\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { API_BASE, getAccessToken, getAuthJSON, postAuthJSON } from \"@/utils/api\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Input } from \"@/components/ui/input\";\nimport { useRouter } from \"next/navigation\";\n\ntype Item = {\n  id: string;\n  name: string;\n  sku: string;\n  sale_price: number;\n  stock_qty: number;\n};\n\ntype InventoryResponse = {\n  items: Array<{\n    id: number | string;\n    medicine_name?: string;\n    sku?: string | null;\n    sell_price?: number | null;\n    quantity?: number | null;\n  }>;\n};\n\ntype CartLine = {\n  id: string;\n  name: string;\n  price: number;\n  qty: number;\n};\n\nexport default function POSPage() {\n  const router = useRouter();\n  const { show } = useToast();\n  const [items, setItems] = useState<Item[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [query, setQuery] = useState(\"\");\n  const [cart, setCart] = useState<CartLine[]>([]);\n  const [sessionId, setSessionId] = useState<string | null>(null);\n  const [lastTxn, setLastTxn] = useState<any | null>(null);\n  const [isCheckingOut, setIsCheckingOut] = useState(false);\n  const [branchId, setBranchId] = useState<string>(\"\");\n  const [branches, setBranches] = useState<{ id: string; name: string }[]>([]);\n\n  function extractReceiptId(tx: any): string | null {\n    if (!tx) return null;\n    if (tx.receipt_id) return String(tx.receipt_id);\n    if (tx.receipt && tx.receipt.id) return String(tx.receipt.id);\n    if (Array.isArray(tx.receipts) && tx.receipts.length > 0) {\n      const r = tx.receipts[0];\n      if (r && r.id) return String(r.id);\n    }\n    return null;\n  }\n\n  function authHeaders(): HeadersInit {\n    const t = getAccessToken();\n    return t ? { Authorization: `Bearer ${t}`, \"Content-Type\": \"application/json\" } : { \"Content-Type\": \"application/json\" };\n  }\n\n  function mapCartResponseToLocal(resp: any): CartLine[] {\n    const lines = Array.isArray(resp?.items) ? resp.items : [];\n    return lines.map((ln: any) => ({\n      id: String(ln.item_id),\n      name: String(ln.name || \"\"),\n      price: Number(ln.unit_price || 0),\n      qty: Number(ln.quantity || 0),\n    }));\n  }\n\n  async function serverGetCart(sid: string) {\n    const res = await fetch(`${API_BASE}/api/v1/pos/sessions/${sid}/cart`, { headers: authHeaders() });\n    if (!res.ok) return;\n    const data = await res.json();\n    setCart(mapCartResponseToLocal(data));\n  }\n\n  async function serverAddToCart(sid: string, itemId: string, quantity: number) {\n    const res = await fetch(`${API_BASE}/api/v1/pos/sessions/${sid}/cart`, {\n      method: \"POST\",\n      headers: authHeaders(),\n      body: JSON.stringify({ item_id: itemId, quantity }),\n    });\n    if (!res.ok) {\n      const msg = await res.text().catch(() => \"\");\n      show({ variant: \"destructive\", title: \"Cart update failed\", description: msg });\n      return;\n    }\n    const data = await res.json();\n    setCart(mapCartResponseToLocal(data));\n  }\n\n  async function serverRemoveFromCart(sid: string, itemId: string) {\n    const res = await fetch(`${API_BASE}/api/v1/pos/sessions/${sid}/cart/${encodeURIComponent(itemId)}`, {\n      method: \"DELETE\",\n      headers: authHeaders(),\n    });\n    if (!res.ok) return;\n    await serverGetCart(sid);\n  }\n\n  async function clearCart() {\n    if (cart.length === 0) return;\n    if (typeof window !== \"undefined\" && !window.confirm(\"Clear all items from cart?\")) return;\n    try {\n      if (sessionId) {\n        await postAuthJSON(`/api/v1/pos/sessions/${sessionId}/clear`, {});\n      }\n    } catch (e) {\n      // non-fatal; still clear local cart\n    }\n    setCart([]);\n    show({ variant: \"success\", title: \"Cart cleared\" });\n  }\n\n  useEffect(() => {\n    let active = true;\n    async function load() {\n      try {\n        const data = await getAuthJSON<InventoryResponse>(\"/api/v1/inventory/items\");\n        const list = Array.isArray(data?.items)\n          ? data.items.map((raw) => ({\n              id: String(raw.id ?? \"\"),\n              name: String(raw.medicine_name ?? \"\"),\n              sku: String(raw.sku ?? \"\"),\n              sale_price: Number(raw.sell_price ?? 0),\n              stock_qty: Number(raw.quantity ?? 0),\n            }))\n          : [];\n        if (!active) return;\n        setItems(list);\n      } catch (e: any) {\n        if (!active) return;\n        show({ variant: \"destructive\", title: \"Failed to load items\", description: e.message || \"\" });\n        setItems([]);\n      } finally {\n        if (active) setLoading(false);\n      }\n    }\n    async function loadBranches() {\n      try {\n        const token = getAccessToken();\n        const tenant = typeof window !== \"undefined\" ? localStorage.getItem(\"tenant_id\") : null;\n        const headers: HeadersInit = {\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n          ...(tenant ? { \"X-Tenant-ID\": tenant } : {}),\n        };\n        const res = await fetch(`${API_BASE}/api/v1/admin/branches`, { headers });\n        if (!res.ok) return;\n        const b = await res.json();\n        if (!active) return;\n        if (Array.isArray(b)) setBranches(b);\n      } catch {}\n    }\n    // restore existing POS session id if present\n    try {\n      const sid = typeof window !== \"undefined\" ? localStorage.getItem(\"pos_session_id\") : null;\n      if (sid) setSessionId(sid);\n    } catch {}\n    load();\n    loadBranches();\n    // hydrate cart from server if we have a session id\n    (async () => {\n      const sid = typeof window !== \"undefined\" ? localStorage.getItem(\"pos_session_id\") : null;\n      if (sid) await serverGetCart(sid);\n    })();\n    return () => {\n      active = false;\n    };\n  }, [show]);\n\n  const filtered = useMemo(() => {\n    const q = query.trim().toLowerCase();\n    if (!q) return items;\n    return items.filter(\n      (it) => it.name.toLowerCase().includes(q) || it.sku.toLowerCase().includes(q)\n    );\n  }, [items, query]);\n\n  async function addToCart(item: Item) {\n    const sid = await ensureSession();\n    if (sid) {\n      await serverAddToCart(sid, item.id, 1);\n    } else {\n      // Fallback local if session cannot be created\n      setCart((prev) => {\n        const found = prev.find((l) => l.id === item.id);\n        if (found) return prev.map((l) => (l.id === item.id ? { ...l, qty: l.qty + 1 } : l));\n        return [...prev, { id: item.id, name: item.name, price: item.sale_price, qty: 1 }];\n      });\n    }\n  }\n\n  async function removeFromCart(id: string) {\n    if (sessionId) {\n      await serverRemoveFromCart(sessionId, id);\n    }\n    setCart((prev) => prev.filter((l) => l.id !== id));\n  }\n\n  async function updateQty(id: string, qty: number) {\n    if (qty <= 0) return removeFromCart(id);\n    const sid = await ensureSession();\n    if (sid) {\n      await serverAddToCart(sid, id, qty);\n    }\n    setCart((prev) => prev.map((l) => (l.id === id ? { ...l, qty } : l)));\n  }\n\n  const subtotal = useMemo(() => cart.reduce((s, l) => s + l.price * l.qty, 0), [cart]);\n  const tax = 0; // adjust when tax rules available\n  const total = subtotal + tax;\n\n  async function ensureSession(): Promise<string | null> {\n    if (sessionId) return sessionId;\n    try {\n      // Create session with cashier context\n      const me = await getAuthJSON<{ id: string }>(\"/api/v1/auth/me\");\n      const payload: any = { cashier_id: me?.id };\n      if (branchId.trim()) payload.branch_id = branchId.trim();\n      const res = await postAuthJSON<{ id: string }>(\"/api/v1/pos/sessions\", payload);\n      const id = (res as any)?.id;\n      if (id) {\n        setSessionId(id);\n        try {\n          if (typeof window !== \"undefined\") localStorage.setItem(\"pos_session_id\", id);\n        } catch {}\n        // Initialize fresh cart state from server\n        await serverGetCart(id);\n        return id;\n      }\n      return null;\n    } catch (e: any) {\n      show({ variant: \"destructive\", title: \"Session creation failed\", description: e.message || \"Provide POS session schema to finalize\" });\n      return null;\n    }\n  }\n\n  async function checkout() {\n    if (cart.length === 0) {\n      show({ variant: \"destructive\", title: \"Cart is empty\", description: \"Add items to proceed\" });\n      return;\n    }\n    if (isCheckingOut) return;\n    setIsCheckingOut(true);\n    const sid = await ensureSession();\n    if (!sid) {\n      setIsCheckingOut(false);\n      return;\n    }\n    const payload = {\n      items: cart.map((l) => ({ item_id: l.id, quantity: l.qty })),\n    };\n    try {\n      const tx = await postAuthJSON(`/api/v1/pos/sessions/${sid}/checkout`, payload);\n      show({ variant: \"success\", title: \"Checkout completed\" });\n      setCart([]);\n      setLastTxn(tx);\n      const rid = extractReceiptId(tx);\n      if (rid) {\n        router.push(`/dashboard/receipts/${rid}`);\n      }\n    } catch (e: any) {\n      const msg = String(e?.message || \"\");\n      const variant = msg.includes(\"409\") ? \"destructive\" : \"destructive\";\n      show({ variant: variant as any, title: \"Checkout failed\", description: msg || \"Please try again\" });\n    }\n    setIsCheckingOut(false);\n  }\n\n  return (\n    <div className=\"grid grid-cols-12 gap-6\">\n      <section className=\"col-span-12 md:col-span-7\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h1 className=\"text-xl font-semibold\">Point of Sale</h1>\n          {loading ? (\n            <Skeleton className=\"h-9 w-64\" />\n          ) : (\n            <Input\n              value={query}\n              onChange={(e) => setQuery(e.target.value)}\n              placeholder=\"Search by name or SKU\"\n              className=\"w-64\"\n            />\n          )}\n        </div>\n        <div className=\"border rounded bg-white overflow-hidden\">\n          {loading ? (\n            <div className=\"max-h-[520px] overflow-auto divide-y\">\n              {Array.from({ length: 8 }).map((_, i) => (\n                <div key={i} className=\"flex items-center justify-between p-3\">\n                  <div className=\"space-y-2\">\n                    <Skeleton className=\"h-4 w-48\" />\n                    <Skeleton className=\"h-3 w-32\" />\n                  </div>\n                  <div className=\"flex items-center gap-4\">\n                    <Skeleton className=\"h-4 w-16\" />\n                    <Skeleton className=\"h-9 w-20\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"max-h-[520px] overflow-auto divide-y\">\n              {filtered.map((it) => (\n                <div key={it.id} className=\"flex items-center justify-between p-3\">\n                  <div>\n                    <div className=\"font-medium\">{it.name}</div>\n                    <div className=\"text-xs text-gray-500\">SKU: {it.sku}</div>\n                  </div>\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"text-sm text-gray-700\">${it.sale_price.toFixed(2)}</div>\n                    <Button variant=\"outline\" onClick={() => addToCart(it)}>\n                      Add\n                    </Button>\n                  </div>\n                </div>\n              ))}\n              {filtered.length === 0 && (\n                <div className=\"p-6 text-gray-500\">No matching items.</div>\n              )}\n            </div>\n          )}\n        </div>\n      </section>\n\n      <aside className=\"col-span-12 md:col-span-5\">\n        <div className=\"border rounded bg-white\">\n          <div className=\"border-b p-3 font-medium flex items-center justify-between\">\n            <span>Cart</span>\n            <button\n              className=\"text-xs border rounded px-2 py-1 hover:bg-gray-50\"\n              onClick={() => {\n                setSessionId(null);\n                try {\n                  if (typeof window !== \"undefined\") localStorage.removeItem(\"pos_session_id\");\n                } catch {}\n                show({ variant: \"success\", title: \"New session ready\" });\n              }}\n            >\n              New Session\n            </button>\n          </div>\n          <div className=\"p-3 border-b flex items-center gap-2\">\n            <div className=\"text-xs text-gray-600\">Branch</div>\n            <select\n              value={branchId}\n              onChange={(e)=>setBranchId(e.target.value)}\n              className=\"border rounded px-2 py-2 text-sm w-80\"\n            >\n              <option value=\"\">Select a branch</option>\n              {branches.map((b)=> (\n                <option key={b.id} value={b.id}>{b.name}</option>\n              ))}\n            </select>\n            <div className=\"text-xs text-gray-500\">Choose before creating a new session</div>\n          </div>\n          {loading ? (\n            <div className=\"divide-y max-h-[420px] overflow-auto\">\n              {Array.from({ length: 4 }).map((_, i) => (\n                <div key={i} className=\"p-3 flex items-center justify-between gap-3\">\n                  <div className=\"min-w-0 space-y-2\">\n                    <Skeleton className=\"h-4 w-40\" />\n                    <Skeleton className=\"h-3 w-24\" />\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Skeleton className=\"h-9 w-20\" />\n                    <Skeleton className=\"h-4 w-12\" />\n                    <Skeleton className=\"h-9 w-24\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <>\n              <div className=\"divide-y max-h-[420px] overflow-auto\">\n                {cart.map((l) => (\n                  <div key={l.id} className=\"p-3 flex items-center justify-between gap-3\">\n                    <div className=\"min-w-0\">\n                      <div className=\"truncate\">{l.name}</div>\n                      <div className=\"text-xs text-gray-500\">${l.price.toFixed(2)} each</div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Input\n                        type=\"number\"\n                        min={1}\n                        value={l.qty}\n                        onChange={(e) => updateQty(l.id, Number(e.target.value))}\n                        className=\"w-20\"\n                      />\n                      <div className=\"w-20 text-right font-medium\">${(l.price * l.qty).toFixed(2)}</div>\n                      <Button variant=\"outline\" onClick={() => removeFromCart(l.id)}>\n                        Remove\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n                {cart.length === 0 && (\n                  <div className=\"p-6 text-gray-500\">No items in cart.</div>\n                )}\n              </div>\n              <div className=\"border-t p-3 space-y-1 text-sm\">\n                <div className=\"flex justify-between\"><span>Subtotal</span><span>${subtotal.toFixed(2)}</span></div>\n                <div className=\"flex justify-between text-gray-600\"><span>Tax</span><span>${tax.toFixed(2)}</span></div>\n                <div className=\"flex justify-between font-semibold\"><span>Total</span><span>${total.toFixed(2)}</span></div>\n                <div className=\"flex gap-2 mt-2\">\n                  <Button className=\"flex-1\" onClick={checkout} disabled={isCheckingOut}>\n                    {isCheckingOut ? \"Processing...\" : \"Checkout\"}\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-36\" onClick={clearCart}>\n                    Clear Cart\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n\n        {lastTxn && (\n          <div className=\"border rounded bg-white mt-4\">\n            <details>\n              <summary className=\"cursor-pointer p-3 border-b font-medium\">Last Transaction</summary>\n              <div className=\"p-3 space-y-2\">\n                <pre className=\"text-xs overflow-auto max-h-64 bg-gray-50 p-2 rounded\">{JSON.stringify(lastTxn, null, 2)}</pre>\n                {extractReceiptId(lastTxn) && (\n                  <Button\n                    onClick={() => router.push(`/dashboard/receipts/${extractReceiptId(lastTxn)}`)}\n                  >\n                    View Receipt\n                  </Button>\n                )}\n                <Button variant=\"outline\" onClick={() => setLastTxn(null)}>Clear</Button>\n              </div>\n            </details>\n          </div>\n        )}\n      </aside>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1,2,3]}