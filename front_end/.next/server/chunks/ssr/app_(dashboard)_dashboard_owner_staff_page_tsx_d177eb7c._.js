module.exports=[32039,a=>{"use strict";a.s(["default",()=>l]);var b=a.i(90944),c=a.i(72131),d=a.i(75320),e=a.i(64037),f=a.i(40695),g=a.i(5522),h=a.i(50463),i=a.i(54161),j=a.i(3130),k=a.i(53071);function l(){let{show:a}=(0,e.useToast)(),[k,l]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)("all"),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),F=(0,c.useCallback)(async(b,c)=>{c?.silent?s(!0):q(!0),u(null);try{let a=await d.StaffAPI.list(b);w(Array.isArray(a)?a:[])}catch(c){let b=c?.message||"Unable to load staff";u(b),a({variant:"destructive",title:"Failed to load staff",description:b})}finally{q(!1),s(!1)}},[a]);(0,c.useEffect)(()=>{let a=!0;return async function(){q(!0);try{let b=await d.AuthAPI.me();if(!a)return;o(b);let c=b?.tenant_id||null;l(c),c?await F(c):u("No tenant attached to this account. Please contact support.")}catch(b){if(!a)return;u(b?.message||"Unable to load user profile")}finally{a&&q(!1)}}(),()=>{a=!1}},[F]);let G=(0,c.useMemo)(()=>{let a=x.trim().toLowerCase();return v.filter(b=>("active"!==z||!1!==b.is_active)&&("inactive"!==z||!1===b.is_active)&&(!a||b.email?.toLowerCase().includes(a)||b.phone?.toLowerCase().includes(a)||b.role?.toLowerCase().includes(a)||b.assigned_branch_name?.toLowerCase().includes(a))).sort((a,b)=>a.email.localeCompare(b.email))},[v,x,z]),H=(0,c.useMemo)(()=>{let a=v.filter(a=>!1!==a.is_active).length,b=v.length-a;return{total:v.length,active:a,inactive:b}},[v]),I=async(b,c)=>{if(k){C(b.id);try{await d.StaffAPI.update(k,b.id,{is_active:c}),a({variant:"success",title:c?"Staff activated":"Staff suspended",description:b.email}),await F(k,{silent:!0})}catch(b){a({variant:"destructive",title:"Update failed",description:b?.message||"Please try again."})}finally{C(null)}}},J=async b=>{if(k&&window.confirm(`Remove ${b.email}? This cannot be undone.`)){C(b.id);try{await d.StaffAPI.remove(k,b.id),a({variant:"success",title:"Staff removed",description:b.email}),await F(k,{silent:!0})}catch(b){a({variant:"destructive",title:"Removal failed",description:b?.message||"Please try again."})}finally{C(null)}}},K=p&&!r;return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("header",{className:"rounded-2xl border border-slate-200 bg-white px-6 py-6 shadow-md lg:flex lg:items-center lg:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-semibold text-slate-900",children:"Team management"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Invite cashiers or managers, grant the right permissions, and keep your operations compliant at all times."})]}),(0,b.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-3 lg:mt-0",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>k&&F(k,{silent:!0}),disabled:!k||r,children:r?"Refreshing...":"Refresh"}),(0,b.jsx)(f.Button,{size:"sm",onClick:()=>E(!0),disabled:!k,className:"bg-emerald-700 hover:bg-emerald-800 text-white",children:"Invite staff"})]})]}),(0,b.jsxs)("section",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsx)(j.Card,{className:"border border-slate-200 bg-white shadow-md",children:(0,b.jsxs)(j.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(j.CardTitle,{className:"text-xs uppercase tracking-wider text-slate-600",children:"Total team members"}),K?(0,b.jsx)(h.Skeleton,{className:"h-7 w-12"}):(0,b.jsx)("div",{className:"text-3xl font-semibold text-slate-900",children:H.total})]})}),(0,b.jsx)(j.Card,{className:"border border-slate-200 bg-white shadow-md",children:(0,b.jsxs)(j.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(j.CardTitle,{className:"text-xs uppercase tracking-wider text-slate-600",children:"Active"}),K?(0,b.jsx)(h.Skeleton,{className:"h-7 w-12"}):(0,b.jsx)("div",{className:"text-3xl font-semibold text-emerald-700",children:H.active})]})}),(0,b.jsx)(j.Card,{className:"border border-amber-200 bg-amber-50 shadow-md",children:(0,b.jsxs)(j.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(j.CardTitle,{className:"text-xs uppercase tracking-wider text-amber-700",children:"Suspended"}),K?(0,b.jsx)(h.Skeleton,{className:"h-7 w-10"}):(0,b.jsx)("div",{className:"text-3xl font-semibold text-amber-700",children:H.inactive})]})})]}),(0,b.jsx)("section",{children:(0,b.jsxs)(j.Card,{className:"border border-slate-200 bg-white shadow-md",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.CardTitle,{className:"text-slate-900",children:"Directory"}),(0,b.jsx)("p",{className:"text-xs uppercase tracking-wider text-slate-600",children:"Search, filter, and manage access in seconds"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(g.Input,{placeholder:"Search email, phone, role",value:x,onChange:a=>y(a.target.value),className:"w-60 border border-slate-300 bg-white text-sm text-slate-900 placeholder:text-slate-500 focus-visible:border-emerald-500 focus-visible:ring-emerald-200"}),(0,b.jsxs)("select",{value:z,onChange:a=>A(a.target.value),className:"border border-slate-300 bg-white px-4 py-2 text-sm text-slate-900 focus:outline-none focus:ring-2 focus:ring-emerald-200 focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"all",children:"All statuses"}),(0,b.jsx)("option",{value:"active",children:"Active only"}),(0,b.jsx)("option",{value:"inactive",children:"Suspended only"})]})]})]}),(0,b.jsx)(j.CardContent,{className:"overflow-hidden border border-slate-200 bg-slate-50 p-0",children:K?(0,b.jsx)(h.Skeleton,{className:"h-64 w-full"}):t?(0,b.jsx)("div",{className:"p-6 text-sm text-red-600",children:t}):0===G.length?(0,b.jsx)("div",{className:"p-6 text-sm text-slate-600",children:"No staff match your filters. Invite a teammate to get started."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm text-slate-800",children:[(0,b.jsx)("thead",{className:"bg-slate-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Email"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Phone"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Role"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Branch"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Status"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wider text-slate-900",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white",children:G.map(a=>{let c=!1!==a.is_active;return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-3 py-3 font-semibold text-slate-900",children:a.email}),(0,b.jsx)("td",{className:"px-3 py-3 text-slate-600",children:a.phone||"—"}),(0,b.jsx)("td",{className:"px-3 py-3 text-slate-600",children:a.role}),(0,b.jsx)("td",{className:"px-3 py-3 text-slate-600",children:a.assigned_branch_name||(a.assigned_branch_id?`#${a.assigned_branch_id}`:"—")}),(0,b.jsx)("td",{className:"px-3 py-3",children:(0,b.jsx)(i.Badge,{variant:c?"default":"secondary",className:c?"border border-emerald-300 bg-emerald-100 text-emerald-800":"border border-amber-300 bg-amber-100 text-amber-800",children:c?"Active":"Suspended"})}),(0,b.jsx)("td",{className:"px-3 py-3",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>I(a,!c),disabled:B===a.id,className:"text-xs font-semibold",children:c?"Suspend":"Activate"}),(0,b.jsx)(f.Button,{variant:"destructive",size:"sm",onClick:()=>J(a),disabled:B===a.id,className:"text-xs font-semibold",children:"Remove"})]})})]},a.id)})})]})})}),(0,b.jsx)(j.CardFooter,{className:"flex flex-col gap-2 border-t border-slate-200 bg-slate-50 p-4 text-xs text-slate-600 md:flex-row md:items-center md:justify-between",children:(0,b.jsxs)("div",{children:["Showing ",G.length," of ",v.length," team members"]})})]})}),(0,b.jsx)(m,{open:D,onOpenChange:E,tenantId:k??void 0,onInvited:async()=>k&&F(k,{silent:!0})})]})}function m({open:a,onOpenChange:h,tenantId:i,onInvited:j}){let{show:l}=(0,e.useToast)(),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s]=(0,c.useState)("staff"),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(!1),z=()=>{n(""),p(""),r(""),w("")};(0,c.useEffect)(()=>{if(!a||!i)return;let b=!0;return d.BranchAPI.list(i,{page_size:100}).then(a=>{b&&u(Array.isArray(a?.items)?a.items.map(a=>({id:Number(a.id),name:String(a.name)})):Array.isArray(a)?a.map(a=>({id:Number(a.id),name:String(a.name)})):[])}).catch(()=>{b&&u([])}),()=>{b=!1}},[a,i]);let A=async a=>{if(a.preventDefault(),!i)return void l({variant:"destructive",title:"No tenant context",description:"Reload and try again."});if(!m||!o)return void l({variant:"destructive",title:"Missing fields",description:"Email and password are required."});y(!0);try{await d.StaffAPI.createCashier(i,{email:m,password:o,phone:q||void 0,role:s,assigned_branch_id:v?Number(v):void 0}),l({variant:"success",title:"Invitation sent",description:m}),z(),h(!1),j()}catch(a){l({variant:"destructive",title:"Failed to invite",description:a?.message||"Please try again."})}finally{y(!1)}};return(0,b.jsx)(k.Sheet,{open:a,onOpenChange:a=>{a||z(),h(a)},children:(0,b.jsxs)(k.SheetContent,{side:"right",className:"max-w-md space-y-5 overflow-y-auto border border-white/10 bg-gradient-to-br from-slate-950/95 via-slate-900/90 to-slate-950/95 p-6 text-emerald-50 backdrop-blur-2xl shadow-[0_36px_140px_-70px_rgba(16,185,129,0.6)]",children:[(0,b.jsxs)(k.SheetHeader,{className:"space-y-2 text-left",children:[(0,b.jsx)(k.SheetTitle,{className:"text-2xl font-semibold text-white",children:"Invite staff member"}),(0,b.jsx)(k.SheetDescription,{className:"text-sm text-emerald-100/70",children:"Create credentials for a cashier or manager. They will update their profile on first login."})]}),(0,b.jsxs)("form",{onSubmit:A,className:"space-y-5",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs uppercase tracking-[0.25em] text-emerald-100/70",children:"Tenant ID"}),(0,b.jsx)(g.Input,{value:i??"",readOnly:!0,disabled:!0,className:"rounded-2xl border border-white/10 bg-white/10 text-sm text-emerald-100"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs uppercase tracking-[0.25em] text-emerald-100/70",children:"Email"}),(0,b.jsx)(g.Input,{type:"email",value:m,onChange:a=>n(a.target.value),required:!0,placeholder:"cashier@branch.com",className:"rounded-2xl border border-white/10 bg-white/10 text-sm text-white placeholder:text-emerald-100/50 focus-visible:border-emerald-300 focus-visible:ring-emerald-300"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs uppercase tracking-[0.25em] text-emerald-100/70",children:"Temporary password"}),(0,b.jsx)(g.Input,{type:"password",value:o,onChange:a=>p(a.target.value),required:!0,placeholder:"Min 6 characters with a capital letter",className:"rounded-2xl border border-white/10 bg-white/10 text-sm text-white placeholder:text-emerald-100/50 focus-visible:border-emerald-300 focus-visible:ring-emerald-300"}),(0,b.jsx)("p",{className:"text-xs text-emerald-100/60",children:"Share securely and remind them to reset on first sign-in."})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs uppercase tracking-[0.25em] text-emerald-100/70",children:"Phone (optional)"}),(0,b.jsx)(g.Input,{value:q,onChange:a=>r(a.target.value),placeholder:"e.g. +2519...",className:"rounded-2xl border border-white/10 bg-white/10 text-sm text-white placeholder:text-emerald-100/50 focus-visible:border-emerald-300 focus-visible:ring-emerald-300"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs uppercase tracking-[0.25em] text-emerald-100/70",children:"Role"}),(0,b.jsx)("div",{className:"w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-2 text-sm text-emerald-100/80 shadow-[0_18px_55px_-35px_rgba(16,185,129,0.5)]",children:"Staff"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs uppercase tracking-[0.25em] text-emerald-100/70",children:"Assign to branch"}),(0,b.jsxs)("select",{value:v,onChange:a=>w(a.target.value),className:"w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-2 text-sm text-emerald-100/80 shadow-[0_18px_55px_-35px_rgba(16,185,129,0.5)] focus:outline-none focus:ring focus:ring-emerald-300/40",children:[(0,b.jsx)("option",{className:"bg-slate-900 text-emerald-100",value:"",children:"Unassigned (all branches)"}),t.map(a=>(0,b.jsx)("option",{value:a.id,className:"bg-slate-900 text-emerald-100",children:a.name},a.id))]}),0===t.length&&(0,b.jsx)("p",{className:"text-xs text-emerald-100/60",children:"No branches found for this tenant yet. Create one first to tie staff to a location."})]}),(0,b.jsxs)(k.SheetFooter,{className:"gap-3 pt-2",children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>{z(),h(!1)},className:"rounded-full border-white/20 bg-white/10 px-5 py-2 text-sm font-semibold text-emerald-100 transition hover:border-emerald-300/40 hover:bg-white/15 hover:text-white",children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:x,className:"rounded-full bg-gradient-to-r from-emerald-500 via-emerald-400 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-[0_22px_60px_-30px_rgba(16,185,129,0.75)] transition hover:from-emerald-500/90 hover:to-sky-500/90",children:x?"Sending...":"Send invite"})]})]})]})})}}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_owner_staff_page_tsx_d177eb7c._.js.map