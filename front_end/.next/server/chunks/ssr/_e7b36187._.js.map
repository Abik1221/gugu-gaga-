{"version":3,"sources":["turbopack:///[project]/components/ui/card.tsx","turbopack:///[project]/components/ui/input.tsx","turbopack:///[project]/components/ui/skeleton.tsx","turbopack:///[project]/app/(dashboard)/pos/page.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"rounded-2xl border border-white/20 bg-white/70 p-6 shadow-[0_20px_70px_-40px_rgba(16,185,129,0.65)] backdrop-blur-md\", className)}\n    {...props}\n  />\n));\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"mb-3 flex items-center justify-between gap-4\", className)} {...props} />\n));\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h4\n    ref={ref}\n    className={cn(\"text-lg font-semibold leading-tight text-emerald-900\", className)}\n    {...props}\n  />\n));\nCardTitle.displayName = \"CardTitle\";\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"text-sm leading-relaxed text-slate-700\", className)} {...props} />\n));\nCardContent.displayName = \"CardContent\";\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"mt-4 flex flex-wrap items-center justify-between gap-3\", className)}\n    {...props}\n  />\n));\nCardFooter.displayName = \"CardFooter\";\n\nexport { Card, CardHeader, CardTitle, CardContent, CardFooter };\n","\"use client\";\nimport * as React from \"react\";\n\nexport interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nexport const Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <input\n        ref={ref}\n        className={\n          \"w-full border rounded px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-200 focus:border-emerald-400 \" +\n          className\n        }\n        {...props}\n      />\n    );\n  }\n);\nInput.displayName = \"Input\";\nexport default Input;\n","\"use client\";\nimport React from \"react\";\n\nexport function Skeleton({ className = \"\" }: { className?: string }) {\n  return <div className={`animate-pulse bg-gray-200 rounded ${className}`} />;\n}\n\nexport function TableSkeletonRows({ rows = 6, cols = 6 }: { rows?: number; cols?: number }) {\n  return (\n    <tbody>\n      {Array.from({ length: rows }).map((_, r) => (\n        <tr key={r} className=\"border-t\">\n          {Array.from({ length: cols }).map((__, c) => (\n            <td key={c} className=\"px-3 py-2\">\n              <Skeleton className=\"h-4 w-full\" />\n            </td>\n          ))}\n        </tr>\n      ))}\n    </tbody>\n  );\n}\n","\"use client\";\n\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\n\nimport {\n  AuthAPI,\n  InventoryAPI,\n  type InventoryItem,\n  SalesAPI,\n  type MedicineListItem,\n  MedicinesAPI,\n} from \"@/utils/api\";\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useToast } from \"@/components/ui/toast\";\n\ntype CartLine = {\n  key: string;\n  medicine: MedicineListItem & { price?: number | null };\n  lot?: InventoryItem | null;\n  quantity: number;\n  unitPrice: number;\n};\n\nconst currencyFormatter = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"ETB\",\n  minimumFractionDigits: 0,\n  maximumFractionDigits: 2,\n});\n\nfunction formatCurrency(value: number): string {\n  return currencyFormatter.format(Number.isFinite(value) ? value : 0);\n}\n\nexport default function POSPage() {\n  const { show } = useToast();\n\n  const [profile, setProfile] = useState<any>(null);\n  const [tenantId, setTenantId] = useState<string | null>(null);\n  const [initializing, setInitializing] = useState(true);\n  const [loadingInventory, setLoadingInventory] = useState(false);\n  const [inventory, setInventory] = useState<InventoryItem[]>([]);\n  const [inventoryBranchFilter, setInventoryBranchFilter] = useState<string>(\"\");\n  const [inventorySearch, setInventorySearch] = useState<string>(\"\");\n  const [inventoryError, setInventoryError] = useState<string | null>(null);\n\n  const [medicines, setMedicines] = useState<MedicineListItem[]>([]);\n  const [loadingMedicines, setLoadingMedicines] = useState(false);\n\n  const [branch, setBranch] = useState<string>(\"\");\n  const [cart, setCart] = useState<CartLine[]>([]);\n  const [submitting, setSubmitting] = useState(false);\n\n  useEffect(() => {\n    let active = true;\n    async function bootstrap() {\n      try {\n        const me = await AuthAPI.me();\n        if (!active) return;\n        setProfile(me);\n        setTenantId(me?.tenant_id || null);\n      } catch (error: any) {\n        if (!active) return;\n        show({ variant: \"destructive\", title: \"Unable to load POS\", description: error?.message || \"Please try again.\" });\n      } finally {\n        if (active) setInitializing(false);\n      }\n    }\n    bootstrap();\n    return () => {\n      active = false;\n    };\n  }, [show]);\n\n  const loadInventory = useCallback(\n    async (tid: string) => {\n      setLoadingInventory(true);\n      setInventoryError(null);\n      try {\n        const { items } = await InventoryAPI.list(tid, {\n          q: inventorySearch || undefined,\n          branch: inventoryBranchFilter || undefined,\n          lowStockOnly: false,\n          pageSize: 100,\n        });\n        setInventory(items);\n      } catch (error: any) {\n        setInventory([]);\n        setInventoryError(error?.message || \"Unable to load inventory\");\n      } finally {\n        setLoadingInventory(false);\n      }\n    },\n    [inventorySearch, inventoryBranchFilter],\n  );\n\n  const loadMedicines = useCallback(\n    async (tid: string) => {\n      setLoadingMedicines(true);\n      try {\n        const { items } = await MedicinesAPI.list(tid, { pageSize: 200 });\n        setMedicines(items);\n      } catch (error: any) {\n        show({ variant: \"destructive\", title: \"Unable to load medicines\", description: error?.message || \"Try again.\" });\n      } finally {\n        setLoadingMedicines(false);\n      }\n    },\n    [show],\n  );\n\n  useEffect(() => {\n    if (!tenantId) return;\n    loadMedicines(tenantId);\n  }, [tenantId, loadMedicines]);\n\n  useEffect(() => {\n    if (!tenantId) return;\n    loadInventory(tenantId);\n  }, [tenantId, loadInventory]);\n\n  const inventoryBranches = useMemo(() => {\n    const set = new Set<string>();\n    inventory.forEach((item) => {\n      if (item.branch) set.add(item.branch);\n    });\n    return Array.from(set).sort();\n  }, [inventory]);\n\n  const cartTotal = useMemo(() => {\n    return cart.reduce((sum, line) => sum + line.quantity * line.unitPrice, 0);\n  }, [cart]);\n\n  const handleAddLine = (lot: InventoryItem) => {\n    const med = medicines.find((m) => m.id === lot.medicine_id);\n    const unitPrice = lot.sell_price ?? 0;\n    if (!med) {\n      show({ variant: \"destructive\", title: \"Medicine not found\", description: \"Unable to match medicine for this lot.\" });\n      return;\n    }\n    setCart((prev) => {\n      const existing = prev.find((line) => line.lot?.id === lot.id);\n      if (existing) {\n        return prev.map((line) =>\n          line.key === existing.key\n            ? { ...line, quantity: Math.min(line.quantity + 1, lot.quantity || 0), unitPrice: unitPrice || line.unitPrice }\n            : line,\n        );\n      }\n      return [\n        ...prev,\n        {\n          key: `${lot.id}-${Date.now()}`,\n          medicine: { ...med, price: unitPrice },\n          lot,\n          quantity: 1,\n          unitPrice: unitPrice || 0,\n        },\n      ];\n    });\n  };\n\n  const handleAddBySearch = (medicine: MedicineListItem) => {\n    setCart((prev) => [\n      ...prev,\n      {\n        key: `${medicine.id}-${Date.now()}`,\n        medicine,\n        lot: null,\n        quantity: 1,\n        unitPrice: 0,\n      },\n    ]);\n  };\n\n  const handleUpdateLine = (key: string, updater: (line: CartLine) => CartLine) => {\n    setCart((prev) => prev.map((line) => (line.key === key ? updater(line) : line)));\n  };\n\n  const handleRemoveLine = (key: string) => {\n    setCart((prev) => prev.filter((line) => line.key !== key));\n  };\n\n  const resetSale = () => {\n    setCart([]);\n    setBranch(\"\");\n  };\n\n  const handleSubmit = async () => {\n    if (!tenantId) return;\n    if (cart.length === 0) {\n      show({ variant: \"destructive\", title: \"Cart empty\", description: \"Add at least one item.\" });\n      return;\n    }\n    const linesPayload = cart.map((line) => ({\n      name_or_sku: line.medicine.sku || line.medicine.name,\n      quantity_units: line.quantity,\n      unit_price: line.unitPrice,\n    }));\n    setSubmitting(true);\n    try {\n      const receipt = await SalesAPI.pos(tenantId, {\n        lines: linesPayload,\n        branch: branch || undefined,\n      });\n      show({\n        variant: \"success\",\n        title: \"Sale completed\",\n        description: `Receipt #${receipt.id} • Total ${formatCurrency(receipt.total)}`,\n      });\n      resetSale();\n      if (tenantId) loadInventory(tenantId);\n    } catch (error: any) {\n      show({ variant: \"destructive\", title: \"Sale failed\", description: error?.message || \"Please try again.\" });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      <header className=\"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-semibold text-gray-900\">Sales console</h1>\n          <p className=\"text-sm text-gray-500\">\n            Look up medicine lots, build the cart, and issue receipts that sync with owner analytics.\n          </p>\n        </div>\n        <div className=\"flex flex-wrap items-center gap-2 text-sm text-gray-600\">\n          <span>Cashier:</span>\n          <span className=\"font-medium text-gray-900\">{profile?.username || \"—\"}</span>\n          <span className=\"hidden sm:inline\">•</span>\n          <span>Tenant:</span>\n\n        </div>\n      </header>\n\n      <section className=\"grid gap-6 xl:grid-cols-5\">\n        <Card className=\"xl:col-span-3\">\n          <CardHeader className=\"flex flex-col gap-3\">\n            <CardTitle>Lot lookup</CardTitle>\n            <div className=\"grid gap-3 md:grid-cols-3\">\n              <Input\n                value={inventorySearch}\n                onChange={(event) => setInventorySearch(event.target.value)}\n                placeholder=\"Search medicine name or SKU\"\n              />\n              <select\n                value={inventoryBranchFilter}\n                onChange={(event) => setInventoryBranchFilter(event.target.value)}\n                className=\"rounded border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm focus:outline-none focus:ring\"\n              >\n                <option value=\"\">All branches</option>\n                {inventoryBranches.map((b) => (\n                  <option key={b} value={b}>\n                    {b}\n                  </option>\n                ))}\n              </select>\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  if (tenantId) loadInventory(tenantId);\n                }}\n                disabled={loadingInventory}\n              >\n                Refresh lots\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {inventoryError && (\n              <div className=\"rounded border border-red-200 bg-red-50 p-2 text-xs text-red-700\">\n                {inventoryError}\n              </div>\n            )}\n            {loadingInventory ? (\n              <Skeleton className=\"h-40 w-full\" />\n            ) : (\n              <div className=\"max-h-[420px] space-y-2 overflow-auto rounded border border-gray-200 bg-white\">\n                {inventory.map((lot) => (\n                  <div\n                    key={lot.id}\n                    className=\"flex items-center justify-between gap-3 border-b px-3 py-2 last:border-b-0\"\n                  >\n                    <div className=\"space-y-1 text-sm\">\n                      <div className=\"font-medium text-gray-900\">{lot.medicine_name}</div>\n                      <div className=\"text-xs text-gray-500\">\n                        SKU: {lot.sku || \"—\"} • Branch: {lot.branch || \"—\"}\n                      </div>\n                      <div className=\"text-xs text-gray-500\">\n                        Qty: {lot.quantity} • Reorder: {lot.reorder_level} • Exp: {lot.expiry_date || \"—\"}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {formatCurrency(lot.sell_price ?? 0)}\n                      </div>\n                      <Button size=\"sm\" onClick={() => handleAddLine(lot)}>\n                        Add\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n                {inventory.length === 0 && (\n                  <div className=\"p-4 text-sm text-gray-500\">No lots match your filters.</div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card className=\"xl:col-span-2\">\n          <CardHeader className=\"flex flex-col gap-2\">\n            <CardTitle>Quick-add medicine</CardTitle>\n            <p className=\"text-xs text-gray-500\">\n              Use this when the lot is not tracked yet. You’ll enter the sale price manually.\n            </p>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {loadingMedicines ? (\n              <Skeleton className=\"h-10 w-full\" />\n            ) : (\n              <select\n                value=\"\"\n                onChange={(event) => {\n                  const id = Number(event.target.value);\n                  const med = medicines.find((m) => m.id === id);\n                  if (med) handleAddBySearch(med);\n                }}\n                className=\"w-full rounded border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm focus:outline-none focus:ring\"\n              >\n                <option value=\"\">Select medicine...</option>\n                {medicines.map((med) => (\n                  <option key={med.id} value={med.id}>\n                    {med.name} {med.sku ? `(${med.sku})` : \"\"}\n                  </option>\n                ))}\n              </select>\n            )}\n          </CardContent>\n        </Card>\n      </section>\n\n      <section>\n        <Card>\n          <CardHeader className=\"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between\">\n            <CardTitle>Sale builder</CardTitle>\n            <div className=\"flex flex-wrap items-center gap-2\">\n              <Input\n                value={branch}\n                onChange={(event) => setBranch(event.target.value)}\n                placeholder=\"Branch / till (optional)\"\n                className=\"w-60\"\n              />\n              <Button variant=\"ghost\" size=\"sm\" onClick={resetSale}>\n                Clear sale\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {cart.length === 0 ? (\n              <div className=\"rounded border border-dashed border-gray-200 p-6 text-center text-sm text-gray-500\">\n                Add items from the left or quick-add a medicine to begin building the cart.\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {cart.map((line) => (\n                  <div key={line.key} className=\"rounded border border-gray-200 bg-white p-3\">\n                    <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\n                      <div>\n                        <div className=\"text-sm font-semibold text-gray-900\">{line.medicine.name}</div>\n                        <div className=\"text-xs text-gray-500\">\n                          {line.medicine.sku ? `SKU ${line.medicine.sku}` : \"Manual entry\"}\n                          {line.lot ? ` • Lot ${line.lot.lot_number || line.lot.id}` : null}\n                        </div>\n                      </div>\n                      <div className=\"flex flex-wrap items-center gap-2 text-sm\">\n                        <label className=\"text-xs uppercase tracking-wide text-gray-500\">Qty</label>\n                        <Input\n                          type=\"number\"\n                          min={1}\n                          value={line.quantity}\n                          onChange={(event) => {\n                            const value = Math.max(1, Number(event.target.value) || 1);\n                            handleUpdateLine(line.key, (l) => ({ ...l, quantity: value }));\n                          }}\n                          className=\"w-24\"\n                        />\n                        {line.lot && (\n                          <span className=\"text-xs text-gray-500\">\n                            Stock: {line.lot.quantity} units\n                          </span>\n                        )}\n                        <label className=\"text-xs uppercase tracking-wide text-gray-500\">Price</label>\n                        <Input\n                          type=\"number\"\n                          min={0}\n                          step=\"0.01\"\n                          value={line.unitPrice}\n                          onChange={(event) => {\n                            const value = Math.max(0, Number(event.target.value) || 0);\n                            handleUpdateLine(line.key, (l) => ({ ...l, unitPrice: value }));\n                          }}\n                          className=\"w-28\"\n                        />\n                        <div className=\"font-semibold text-gray-900\">\n                          {formatCurrency(line.quantity * line.unitPrice)}\n                        </div>\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => handleRemoveLine(line.key)}>\n                          Remove\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n          <CardFooter className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\n            <div className=\"text-sm text-gray-600\">\n              Cart lines: {cart.length} • Total quantity: {cart.reduce((sum, l) => sum + l.quantity, 0)}\n            </div>\n            <div className=\"flex flex-col gap-2 text-right\">\n              <div className=\"text-lg font-semibold text-gray-900\">\n                Total due: {formatCurrency(cartTotal)}\n              </div>\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" onClick={resetSale}>\n                  Reset\n                </Button>\n                <Button onClick={handleSubmit} disabled={submitting || cart.length === 0}>\n                  {submitting ? \"Processing...\" : \"Complete sale\"}\n                </Button>\n              </div>\n            </div>\n          </CardFooter>\n        </Card>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}