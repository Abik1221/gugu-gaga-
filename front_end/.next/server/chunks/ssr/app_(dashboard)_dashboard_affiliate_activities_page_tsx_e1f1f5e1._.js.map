{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/habtamusemagn/Desktop/last/gugu-gaga-/front_end/app/%28dashboard%29/dashboard/affiliate/activities/page.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useState } from \"react\";\nimport { API_BASE, getAccessToken, getAuthJSON } from \"@/utils/api\";\nimport { format } from \"date-fns\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\ntype Activity = {\n  id: string;\n  type: 'referral' | 'commission' | 'payout' | 'other';\n  title: string;\n  description: string;\n  amount?: number;\n  status?: string;\n  created_at: string;\n  metadata?: Record<string, any>;\n};\n\ntype Me = { \n  id: string; \n  tenant_id?: string;\n  full_name?: string;\n  email: string;\n};\n\nexport default function AffiliateActivitiesPage() {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [me, setMe] = useState<Me | null>(null);\n  const [activities, setActivities] = useState<Activity[]>([]);\n\n  useEffect(() => {\n    let active = true;\n    \n    async function loadActivities() {\n      try {\n        // First get the current user's info\n        const user = await getAuthJSON<Me>(\"/api/v1/auth/me\");\n        if (!active) return;\n        setMe(user);\n        \n        // Then fetch the activities\n        const token = getAccessToken();\n        const res = await fetch(`${API_BASE}/api/v1/affiliate/activities`, {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            ...(token ? { Authorization: `Bearer ${token}` } : {}),\n            ...(user?.tenant_id ? { \"X-Tenant-ID\": user.tenant_id } : {}),\n          },\n        });\n        \n        if (!res.ok) {\n          throw new Error(await res.text().catch(() => \"Failed to load activities\"));\n        }\n        \n        const data = await res.json();\n        if (!active) return;\n        \n        // Transform the data to match our Activity type\n        const formattedActivities: Activity[] = data.map((item: any) => ({\n          id: item.id,\n          type: item.type || 'other',\n          title: item.title || 'Activity',\n          description: item.description || '',\n          amount: item.amount,\n          status: item.status,\n          created_at: item.created_at,\n          metadata: item.metadata || {},\n        }));\n        \n        setActivities(formattedActivities);\n      } catch (e: any) {\n        if (!active) return;\n        console.error('Error loading activities:', e);\n        setError(e.message || \"Failed to load activities\");\n      } finally {\n        if (active) setLoading(false);\n      }\n    }\n    \n    loadActivities();\n    return () => { active = false; };\n  }, []);\n  \n  const getActivityIcon = (type: string) => {\n    switch (type) {\n      case 'referral':\n        return 'ðŸ‘¥';\n      case 'commission':\n        return 'ðŸ’°';\n      case 'payout':\n        return 'ðŸ’¸';\n      default:\n        return 'ðŸ“';\n    }\n  };\n  \n  const getStatusColor = (status?: string) => {\n    if (!status) return 'bg-gray-100 text-gray-800';\n    switch (status.toLowerCase()) {\n      case 'completed':\n      case 'success':\n      case 'paid':\n        return 'bg-green-100 text-green-800';\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'failed':\n      case 'rejected':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-8 w-64\" />\n        <div className=\"space-y-4\">\n          {Array.from({ length: 5 }).map((_, i) => (\n            <div key={i} className=\"p-4 border rounded-lg\">\n              <div className=\"flex items-start space-x-4\">\n                <Skeleton className=\"h-10 w-10 rounded-full\" />\n                <div className=\"flex-1 space-y-2\">\n                  <Skeleton className=\"h-4 w-3/4\" />\n                  <Skeleton className=\"h-3 w-1/2\" />\n                </div>\n                <Skeleton className=\"h-4 w-20\" />\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  \n  if (error) {\n    return (\n      <div className=\"p-4 bg-red-50 text-red-700 rounded-md\">\n        <p className=\"font-medium\">Error loading activities</p>\n        <p className=\"text-sm mt-1\">{error}</p>\n        <button\n          onClick={() => window.location.reload()}\n          className=\"mt-2 text-sm text-red-700 hover:underline\"\n        >\n          Try again\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Your Activities</h1>\n          <p className=\"text-sm text-gray-500 mt-1\">\n            Track your affiliate activities, referrals, and earnings\n          </p>\n        </div>\n      </div>\n\n      {activities.length === 0 ? (\n        <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n          <div className=\"text-gray-400 mb-2\">ðŸ“Š</div>\n          <h3 className=\"text-lg font-medium text-gray-900\">No activities yet</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Your affiliate activities will appear here when you start referring users.\n          </p>\n        </div>\n      ) : (\n        <div className=\"space-y-4\">\n          {activities.map((activity) => (\n            <div \n              key={activity.id} \n              className=\"bg-white rounded-lg border p-4 hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0 h-10 w-10 rounded-full bg-blue-50 flex items-center justify-center text-lg mr-3\">\n                  {getActivityIcon(activity.type)}\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"font-medium text-gray-900\">{activity.title}</h3>\n                    {activity.amount !== undefined && (\n                      <span className=\"text-sm font-medium text-green-600\">\n                        +${activity.amount.toFixed(2)}\n                      </span>\n                    )}\n                  </div>\n                  <p className=\"text-sm text-gray-600 mt-1\">{activity.description}</p>\n                  <div className=\"mt-2 flex items-center justify-between text-xs text-gray-500\">\n                    <time dateTime={activity.created_at}>\n                      {format(new Date(activity.created_at), 'MMM d, yyyy h:mm a')}\n                    </time>\n                    {activity.status && (\n                      <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(activity.status)}`}>\n                        {activity.status.charAt(0).toUpperCase() + activity.status.slice(1)}\n                      </span>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n      \n      {/* Add pagination if needed in the future */}\n      {/* <div className=\"flex items-center justify-between text-sm\">\n        <div>Page 1 of 1 â€¢ {activities.length} result(s)</div>\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" disabled>Previous</Button>\n          <Button variant=\"outline\" disabled>Next</Button>\n        </div>\n      </div> */}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}