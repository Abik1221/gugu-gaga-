{"version":3,"sources":["turbopack:///[project]/app/(dashboard)/dashboard/staff/pos/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { AuthAPI } from \"@/utils/api\";\n\ninterface CartItem {\n  medicine_id: number;\n  name: string;\n  sku: string;\n  quantity: number;\n  unit_price: number;\n  total: number;\n}\n\nexport default function StaffPOS() {\n  const { show } = useToast();\n  const [user, setUser] = useState<any>(null);\n  const [cart, setCart] = useState<CartItem[]>([]);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [quantity, setQuantity] = useState(1);\n  const [unitPrice, setUnitPrice] = useState(\"\");\n  const [processing, setProcessing] = useState(false);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const me = await AuthAPI.me();\n        setUser(me);\n      } catch (err) {\n        console.error(\"Failed to load user:\", err);\n      }\n    })();\n  }, []);\n\n  const addToCart = () => {\n    if (!searchQuery.trim() || !unitPrice || quantity <= 0) {\n      show({\n        variant: \"destructive\",\n        title: \"Invalid input\",\n        description: \"Please fill all fields correctly\",\n      });\n      return;\n    }\n\n    const price = parseFloat(unitPrice);\n    if (isNaN(price) || price <= 0) {\n      show({\n        variant: \"destructive\",\n        title: \"Invalid price\",\n        description: \"Please enter a valid price\",\n      });\n      return;\n    }\n\n    const newItem: CartItem = {\n      medicine_id: Date.now(), // Temporary ID\n      name: searchQuery,\n      sku: searchQuery,\n      quantity,\n      unit_price: price,\n      total: quantity * price,\n    };\n\n    setCart([...cart, newItem]);\n    setSearchQuery(\"\");\n    setQuantity(1);\n    setUnitPrice(\"\");\n  };\n\n  const removeFromCart = (index: number) => {\n    setCart(cart.filter((_, i) => i !== index));\n  };\n\n  const updateQuantity = (index: number, newQuantity: number) => {\n    if (newQuantity <= 0) return;\n    const updatedCart = cart.map((item, i) => \n      i === index \n        ? { ...item, quantity: newQuantity, total: newQuantity * item.unit_price }\n        : item\n    );\n    setCart(updatedCart);\n  };\n\n  const getTotalAmount = () => {\n    return cart.reduce((sum, item) => sum + item.total, 0);\n  };\n\n  const processSale = async () => {\n    if (cart.length === 0) {\n      show({\n        variant: \"destructive\",\n        title: \"Empty cart\",\n        description: \"Add items to cart before processing sale\",\n      });\n      return;\n    }\n\n    setProcessing(true);\n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      show({\n        variant: \"success\",\n        title: \"Sale completed\",\n        description: `Transaction processed successfully. Total: $${getTotalAmount().toFixed(2)}`,\n      });\n      \n      setCart([]);\n    } catch (err: any) {\n      show({\n        variant: \"destructive\",\n        title: \"Sale failed\",\n        description: err?.message || \"Failed to process sale\",\n      });\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Point of Sale</h2>\n        <p className=\"text-gray-600\">Process customer transactions</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        {/* Product Search & Add */}\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Add Items</h2>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Medicine Name/SKU\n              </label>\n              <Input\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                placeholder=\"Search medicine by name or SKU\"\n                className=\"text-black\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Quantity\n                </label>\n                <Input\n                  type=\"number\"\n                  value={quantity}\n                  onChange={(e) => setQuantity(parseInt(e.target.value) || 1)}\n                  min=\"1\"\n                  className=\"text-black\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Unit Price ($)\n                </label>\n                <Input\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={unitPrice}\n                  onChange={(e) => setUnitPrice(e.target.value)}\n                  placeholder=\"0.00\"\n                  className=\"text-black\"\n                />\n              </div>\n            </div>\n\n            <Button \n              onClick={addToCart}\n              className=\"w-full bg-blue-600 hover:bg-blue-700\"\n            >\n              Add to Cart\n            </Button>\n          </div>\n        </div>\n\n        {/* Cart */}\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">\n            Cart ({cart.length} items)\n          </h2>\n\n          {cart.length === 0 ? (\n            <div className=\"text-center py-8 text-gray-500\">\n              <svg className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5-6m0 0h15.5M7 13h10m0 0v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6z\" />\n              </svg>\n              Cart is empty\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {cart.map((item, index) => (\n                <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-gray-900\">{item.name}</p>\n                    <p className=\"text-sm text-gray-600\">${item.unit_price.toFixed(2)} each</p>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => updateQuantity(index, item.quantity - 1)}\n                    >\n                      -\n                    </Button>\n                    <span className=\"w-8 text-center\">{item.quantity}</span>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => updateQuantity(index, item.quantity + 1)}\n                    >\n                      +\n                    </Button>\n                    <span className=\"w-16 text-right font-medium\">\n                      ${item.total.toFixed(2)}\n                    </span>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => removeFromCart(index)}\n                      className=\"text-red-600 hover:text-red-700\"\n                    >\n                      Ã—\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {cart.length > 0 && (\n            <div className=\"mt-6 pt-4 border-t border-gray-200\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <span className=\"text-lg font-semibold text-gray-900\">Total:</span>\n                <span className=\"text-2xl font-bold text-green-600\">\n                  ${getTotalAmount().toFixed(2)}\n                </span>\n              </div>\n              <Button\n                onClick={processSale}\n                disabled={processing}\n                className=\"w-full bg-green-600 hover:bg-green-700 text-lg py-3\"\n              >\n                {processing ? \"Processing...\" : \"Complete Sale\"}\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}