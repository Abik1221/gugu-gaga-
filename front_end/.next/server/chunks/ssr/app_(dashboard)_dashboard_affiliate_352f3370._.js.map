{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/habtamusemagn/Desktop/last/gugu-gaga-/front_end/app/%28dashboard%29/dashboard/affiliate/_hooks/use-affiliate-dashboard.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { AffiliateAPI } from \"@/utils/api\";\nimport { useToast } from \"@/components/ui/toast\";\n\nexport type AffiliateStats = {\n  currentCommission: number;\n  pendingPayout: number;\n  paidPayout: number;\n  referrals: number;\n};\n\nexport type AffiliateLink = {\n  token: string;\n  url: string;\n  active: boolean;\n  createdAt?: string | null;\n};\n\nexport type AffiliateDashboardSummary = {\n  percent?: number;\n  amount?: number;\n  tenants?: string[];\n  [key: string]: unknown;\n};\n\nexport type AffiliatePayout = {\n  id: number;\n  month: string;\n  percent: number;\n  amount: number;\n  status: string;\n};\n\ntype DashboardState = {\n  loading: boolean;\n  error: string | null;\n  stats: AffiliateStats;\n  dash: AffiliateDashboardSummary | null;\n  links: AffiliateLink[];\n  payouts: AffiliatePayout[];\n  canCreateMore: boolean;\n  monthLabel: string;\n  payoutMonth: string;\n  payoutPercent: number;\n  requestingPayout: boolean;\n  setPayoutMonth: (value: string) => void;\n  setPayoutPercent: (value: number) => void;\n  actions: {\n    refresh: () => Promise<void>;\n    createLink: () => Promise<void>;\n    deactivate: (token: string) => Promise<void>;\n    rotate: (token: string) => Promise<void>;\n    copyLink: (url: string) => Promise<void>;\n    requestPayout: () => Promise<void>;\n  };\n};\n\nconst DEFAULT_STATS: AffiliateStats = {\n  currentCommission: 0,\n  pendingPayout: 0,\n  paidPayout: 0,\n  referrals: 0,\n};\n\nconst DEFAULT_MONTH = new Date().toISOString().slice(0, 7);\nconst MAX_ACTIVE_LINKS = 2;\n\nfunction toNumber(value: unknown): number {\n  if (typeof value === \"number\" && !Number.isNaN(value)) return value;\n  if (typeof value === \"string\") {\n    const parsed = Number.parseFloat(value);\n    return Number.isFinite(parsed) ? parsed : 0;\n  }\n  return 0;\n}\n\nfunction extractStats(data: any): AffiliateStats {\n  const source = data?.stats ?? data ?? {};\n  const payouts = source?.payouts ?? {};\n  return {\n    currentCommission:\n      toNumber(\n        source.currentCommission ??\n          source.current_commission ??\n          source.current ??\n          source.amount ??\n          source.commission ??\n          0\n      ),\n    pendingPayout: toNumber(\n      source.pendingPayout ??\n        source.pending_payout ??\n        source.pending ??\n        payouts.pending_total ??\n        payouts.pending ??\n        0\n    ),\n    paidPayout: toNumber(\n      source.paidPayout ??\n        source.paid_payout ??\n        source.paid ??\n        payouts.paid_total ??\n        payouts.paid ??\n        0\n    ),\n    referrals: toNumber(\n      source.referrals ??\n        source.total_referrals ??\n        source.affiliates ??\n        source.referrals_count ??\n        source.activated_referrals ??\n        0\n    ),\n  };\n}\n\nfunction normalizeLinks(payload: any): AffiliateLink[] {\n  const list = Array.isArray(payload)\n    ? payload\n    : Array.isArray(payload?.links)\n    ? payload.links\n    : [];\n\n  return list\n    .map((item: any) => ({\n      token: String(item?.token ?? item?.code ?? \"\"),\n      url: String(item?.url ?? item?.link ?? item?.register_url ?? \"\"),\n      active: Boolean(item?.active ?? item?.is_active ?? item?.status === \"active\"),\n      createdAt: item?.created_at ?? item?.createdAt ?? null,\n    }))\n    .filter((item: AffiliateLink) => item.token && item.url);\n}\n\nfunction extractMonthLabel(data: any): string {\n  if (typeof data?.year === \"number\" && typeof data?.month === \"number\") {\n    try {\n      return new Intl.DateTimeFormat(\"en-US\", { month: \"long\", year: \"numeric\" }).format(\n        new Date(data.year, data.month - 1)\n      );\n    } catch {\n      return `${data.year}-${String(data.month).padStart(2, \"0\")}`;\n    }\n  }\n  const month =\n    data?.monthLabel ??\n    data?.month_label ??\n    data?.current_month_label ??\n    data?.stats?.month_label ??\n    null;\n  if (month) return String(month);\n  return new Intl.DateTimeFormat(\"en-US\", { month: \"long\", year: \"numeric\" }).format(new Date());\n}\n\nfunction extractPercent(data: any): number {\n  return toNumber(\n    data?.percent ??\n      data?.commission_percent ??\n      data?.stats?.percent ??\n      data?.current_percent ??\n      5\n  );\n}\n\nfunction normalizePayout(item: any): AffiliatePayout {\n  return {\n    id: Number(item?.id ?? 0),\n    month: item?.month ? String(item.month) : \"\",\n    percent: toNumber(item?.percent ?? 0),\n    amount: toNumber(item?.amount ?? 0),\n    status: String(item?.status ?? \"pending\"),\n  };\n}\n\nfunction getErrorMessage(error: unknown): string {\n  if (typeof error === \"string\") return error;\n  if (error instanceof Error) return error.message;\n  try {\n    return JSON.stringify(error);\n  } catch {\n    return \"Unexpected error\";\n  }\n}\n\nexport function useAffiliateDashboard(): DashboardState {\n  const { show } = useToast();\n\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [stats, setStats] = useState<AffiliateStats>(DEFAULT_STATS);\n  const [dash, setDash] = useState<AffiliateDashboardSummary | null>(null);\n  const [links, setLinks] = useState<AffiliateLink[]>([]);\n  const [payouts, setPayouts] = useState<AffiliatePayout[]>([]);\n  const [canCreateMore, setCanCreateMore] = useState<boolean>(true);\n  const [monthLabel, setMonthLabel] = useState<string>(extractMonthLabel(null));\n  const [payoutMonth, setPayoutMonthState] = useState<string>(DEFAULT_MONTH);\n  const [payoutPercent, setPayoutPercentState] = useState<number>(5);\n  const [requestingPayout, setRequestingPayout] = useState<boolean>(false);\n\n  const hasInitialized = useRef(false);\n\n  const refreshLinks = useCallback(async () => {\n    const response = await AffiliateAPI.getLinks();\n    const normalized = normalizeLinks(response);\n    setLinks(normalized);\n    const activeCount = normalized.filter((link) => link.active).length;\n    setCanCreateMore(activeCount < MAX_ACTIVE_LINKS);\n  }, []);\n\n  const refreshDashboard = useCallback(async () => {\n    const response = await AffiliateAPI.dashboard();\n    setStats(extractStats(response));\n    const snapshot =\n      response?.dash ??\n      response?.current_month ??\n      response?.summary ??\n      response?.stats?.current_month ??\n      response ??\n      null;\n    setDash(snapshot ?? null);\n    setMonthLabel(extractMonthLabel(response));\n    const percent = extractPercent(response);\n    const nextMonth =\n      response?.next_payout_month ??\n      response?.payout_month ??\n      (typeof response?.year === \"number\" && typeof response?.month === \"number\"\n        ? `${response.year}-${String(response.month).padStart(2, \"0\")}`\n        : null);\n\n    if (!hasInitialized.current) {\n      setPayoutPercentState(percent > 0 ? percent : 5);\n      setPayoutMonthState(typeof nextMonth === \"string\" && nextMonth ? nextMonth : DEFAULT_MONTH);\n      hasInitialized.current = true;\n    }\n  }, []);\n\n  const refreshPayouts = useCallback(async () => {\n    const response = await AffiliateAPI.payouts();\n    if (Array.isArray(response)) {\n      setPayouts(response.map(normalizePayout));\n    } else {\n      setPayouts([]);\n    }\n  }, []);\n\n  const refresh = useCallback(async () => {\n    try {\n      setLoading(true);\n      await Promise.all([refreshDashboard(), refreshLinks(), refreshPayouts()]);\n      setError(null);\n    } catch (err) {\n      const message = getErrorMessage(err);\n      console.error(\"[useAffiliateDashboard] refresh failed\", err);\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }, [refreshDashboard, refreshLinks, refreshPayouts]);\n\n  useEffect(() => {\n    refresh();\n  }, [refresh]);\n\n  const handleCreateLink = useCallback(async () => {\n    try {\n      await AffiliateAPI.createLink();\n      await refreshLinks();\n      show({ variant: \"success\", title: \"Link created\", description: \"A new referral link is now active.\" });\n    } catch (err) {\n      const message = getErrorMessage(err);\n      show({ variant: \"destructive\", title: \"Failed to create link\", description: message });\n    }\n  }, [refreshLinks, show]);\n\n  const handleRotateLink = useCallback(\n    async (token: string) => {\n      try {\n        await AffiliateAPI.rotate(token);\n        await refreshLinks();\n        show({ variant: \"success\", title: \"Link rotated\", description: \"The referral link has been refreshed.\" });\n      } catch (err) {\n        const message = getErrorMessage(err);\n        show({ variant: \"destructive\", title: \"Failed to rotate\", description: message });\n      }\n    },\n    [refreshLinks, show]\n  );\n\n  const handleDeactivateLink = useCallback(\n    async (token: string) => {\n      try {\n        await AffiliateAPI.deactivate(token);\n        await refreshLinks();\n        show({ variant: \"success\", title: \"Link deactivated\", description: \"The referral link is now inactive.\" });\n      } catch (err) {\n        const message = getErrorMessage(err);\n        show({ variant: \"destructive\", title: \"Failed to deactivate\", description: message });\n      }\n    },\n    [refreshLinks, show]\n  );\n\n  const handleCopyLink = useCallback(\n    async (url: string) => {\n      try {\n        if (typeof navigator !== \"undefined\" && navigator.clipboard) {\n          await navigator.clipboard.writeText(url);\n          show({ variant: \"success\", title: \"Copied\", description: \"Referral link copied to clipboard.\" });\n        } else {\n          throw new Error(\"Clipboard API unavailable\");\n        }\n      } catch (err) {\n        const message = getErrorMessage(err);\n        show({ variant: \"destructive\", title: \"Copy failed\", description: message });\n      }\n    },\n    [show]\n  );\n\n  const handleRequestPayout = useCallback(async () => {\n    setRequestingPayout(true);\n    try {\n      await AffiliateAPI.requestPayout(payoutMonth || undefined, payoutPercent || 5);\n      show({ variant: \"success\", title: \"Payout requested\", description: \"Finance will review your request shortly.\" });\n      await Promise.all([refreshDashboard(), refreshPayouts()]);\n    } catch (err) {\n      const message = getErrorMessage(err);\n      show({ variant: \"destructive\", title: \"Request failed\", description: message });\n    } finally {\n      setRequestingPayout(false);\n    }\n  }, [payoutMonth, payoutPercent, refreshDashboard, refreshPayouts, show]);\n\n  const actions = useMemo(\n    () => ({\n      refresh,\n      createLink: handleCreateLink,\n      deactivate: handleDeactivateLink,\n      rotate: handleRotateLink,\n      copyLink: handleCopyLink,\n      requestPayout: handleRequestPayout,\n    }),\n    [refresh, handleCreateLink, handleDeactivateLink, handleRotateLink, handleCopyLink, handleRequestPayout]\n  );\n\n  return {\n    loading,\n    error,\n    stats,\n    dash,\n    links,\n    payouts,\n    canCreateMore,\n    monthLabel,\n    payoutMonth,\n    payoutPercent,\n    requestingPayout,\n    setPayoutMonth: setPayoutMonthState,\n    setPayoutPercent: setPayoutPercentState,\n    actions,\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 310, "column": 0}, "map": {"version":3,"sources":["file:///home/habtamusemagn/Desktop/last/gugu-gaga-/front_end/app/%28dashboard%29/dashboard/affiliate/_context/affiliate-dashboard-context.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext } from \"react\";\nimport {\n  useAffiliateDashboard,\n  type AffiliateLink,\n  type AffiliateStats,\n  type AffiliateDashboardSummary,\n} from \"../_hooks/use-affiliate-dashboard\";\n\nconst AffiliateDashboardContext = createContext<ReturnType<typeof useAffiliateDashboard> | null>(null);\n\nexport function AffiliateDashboardProvider({ children }: { children: React.ReactNode }) {\n  const value = useAffiliateDashboard();\n  return <AffiliateDashboardContext.Provider value={value}>{children}</AffiliateDashboardContext.Provider>;\n}\n\nexport function useAffiliateDashboardContext() {\n  const context = useContext(AffiliateDashboardContext);\n  if (!context) {\n    throw new Error(\"useAffiliateDashboardContext must be used within AffiliateDashboardProvider\");\n  }\n  return context;\n}\n\nexport type { AffiliateStats, AffiliateLink, AffiliateDashboardSummary };\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAUA,MAAM,0CAA4B,IAAA,4XAAa,EAAkD;AAE1F,SAAS,2BAA2B,EAAE,QAAQ,EAAiC;IACpF,MAAM,QAAQ,IAAA,kNAAqB;IACnC,qBAAO,oZAAC,0BAA0B,QAAQ;QAAC,OAAO;kBAAQ;;;;;;AAC5D;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,yXAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 346, "column": 0}, "map": {"version":3,"sources":["file:///home/habtamusemagn/Desktop/last/gugu-gaga-/front_end/app/%28dashboard%29/dashboard/affiliate/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useMemo } from \"react\";\nimport Link from \"next/link\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { StatCard, MiniStat, SectionCard } from \"./_components/cards\";\nimport { useAffiliateDashboardContext } from \"./_context/affiliate-dashboard-context\";\n\nexport default function AffiliateOverviewPage() {\n  const { stats, dash, monthLabel, payoutPercent, actions, canCreateMore } = useAffiliateDashboardContext();\n\n  const highlightItems = [\n    `You’re earning a ${payoutPercent}% commission rate this month.`,\n    `${stats.referrals.toLocaleString()} referred pharmacies are being tracked in real-time.`,\n    `${formatCurrency(stats.paidPayout)} has already been paid out – keep sharing links to grow it.`,\n  ];\n\n  const summaryCards = useMemo(\n    () => [\n      {\n        title: \"Current commission\",\n        value: formatCurrency(stats.currentCommission),\n        description: `${monthLabel} projected payout`,\n      },\n      {\n        title: \"Pending review\",\n        value: formatCurrency(stats.pendingPayout),\n        description: \"Awaiting finance approval\",\n      },\n      {\n        title: \"Paid to date\",\n        value: formatCurrency(stats.paidPayout),\n        description: \"Lifetime transferred earnings\",\n      },\n      {\n        title: \"Active referrals\",\n        value: stats.referrals.toLocaleString(),\n        description: \"Pharmacies onboarded via your links\",\n      },\n    ],\n    [monthLabel, stats.currentCommission, stats.paidPayout, stats.pendingPayout, stats.referrals]\n  );\n\n  const referredTenants = dash?.tenants ?? [];\n\n  return (\n    <div>dashboard of affiliate</div>\n    // <div className=\"pb-16\">\n    //   <motion.section\n    //     initial={{ opacity: 0, y: -20 }}\n    //     animate={{ opacity: 1, y: 0 }}\n    //     transition={{ duration: 0.5, ease: \"easeOut\" }}\n    //     className=\"relative overflow-hidden rounded-[32px] border border-slate-200 bg-white p-8 shadow-[0_40px_100px_-60px_rgba(15,118,110,0.45)] sm:p-10\"\n    //   >\n    //     <div className=\"pointer-events-none absolute -top-28 right-[-10%] h-72 w-72 rounded-full bg-emerald-100/70 blur-3xl\" />\n    //     <div className=\"pointer-events-none absolute -bottom-36 left-[-12%] h-80 w-80 rounded-full bg-slate-100 blur-[120px]\" />\n    //     <div className=\"pointer-events-none absolute inset-x-0 top-1/3 h-24 bg-gradient-to-r from-emerald-50 via-transparent to-emerald-100/60 blur-2xl\" />\n\n    //     <div className=\"relative flex flex-col gap-10 lg:flex-row lg:items-center lg:justify-between\">\n    //       <div className=\"max-w-2xl space-y-6\">\n    //         <p className=\"inline-flex items-center gap-2 rounded-full border border-emerald-100 bg-emerald-50 px-4 py-1 text-xs font-semibold uppercase tracking-[0.35em] text-emerald-700\">\n    //           Affiliate dashboard\n    //         </p>\n    //         <div className=\"space-y-4\">\n    //           <h1 className=\"text-3xl font-semibold leading-tight text-slate-900 sm:text-4xl\">\n    //             Grow partner revenue with the same polish as your landing page.\n    //           </h1>\n    //           <p className=\"text-base text-slate-600\">\n    //             Keep your pharmacy partners engaged with a calm, minimal control center. Review earnings, generate links, and submit payout requests with live numbers pulled directly from the partner API.\n    //           </p>\n    //         </div>\n    //         <div className=\"flex flex-col gap-3 pt-2 sm:flex-row sm:items-center\">\n    //           <Button\n    //             onClick={() => {\n    //               void actions.createLink();\n    //             }}\n    //             className=\"rounded-xl bg-emerald-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700\"\n    //             disabled={!canCreateMore}\n    //           >\n    //             Create referral link\n    //           </Button>\n    //           <Button\n    //             asChild\n    //             variant=\"outline\"\n    //             className=\"rounded-xl border-slate-300 px-6 py-2 text-sm font-semibold text-slate-700 transition hover:border-emerald-200 hover:bg-emerald-50/60 hover:text-emerald-700\"\n    //           >\n    //             <Link href=\"/dashboard/affiliate/payouts\">Request payout</Link>\n    //           </Button>\n    //         </div>\n    //       </div>\n\n    //       <div className=\"w-full max-w-sm space-y-4 rounded-3xl border border-slate-200 bg-slate-50/70 p-6 shadow-inner shadow-emerald-100/60 backdrop-blur\">\n    //         <h2 className=\"text-sm font-semibold uppercase tracking-[0.28em] text-slate-500\">Why teams stay</h2>\n    //         <ul className=\"space-y-3 text-sm text-slate-600\">\n    //           {highlightItems.map((item) => (\n    //             <li key={item} className=\"rounded-2xl border border-white/60 bg-white/80 px-4 py-3 shadow-sm\">\n    //               {item}\n    //             </li>\n    //           ))}\n    //         </ul>\n    //       </div>\n    //     </div>\n    //   </motion.section>\n\n    //   <motion.section\n    //     initial={{ opacity: 0, y: 20 }}\n    //     animate={{ opacity: 1, y: 0 }}\n    //     transition={{ duration: 0.45, ease: \"easeOut\" }}\n    //     className=\"mt-10 grid gap-6 lg:grid-cols-5\"\n    //   >\n    //     <div className=\"lg:col-span-2\">\n    //       <SectionCard\n    //         title=\"Performance snapshot\"\n    //         description={`Live metrics for ${monthLabel}. Refreshes automatically after actions.`}\n    //       >\n    //         <div className=\"grid gap-4 sm:grid-cols-2\">\n    //           {summaryCards.map((card) => (\n    //             <StatCard key={card.title} title={card.title} value={card.value} description={card.description} />\n    //           ))}\n    //         </div>\n    //       </SectionCard>\n    //     </div>\n    //     <div className=\"lg:col-span-3\">\n    //       <SectionCard\n    //         title=\"Referred pharmacies\"\n    //         description=\"Tenant IDs credited to your affiliate account this period.\"\n    //       >\n    //         {referredTenants.length === 0 ? (\n    //           <div className=\"rounded-2xl border border-emerald-100/40 bg-emerald-50/50 p-5 text-sm text-emerald-700\">\n    //             Share your referral link to start tracking partner pharmacies here.\n    //           </div>\n    //         ) : (\n    //           <div className=\"grid gap-3 sm:grid-cols-2\">\n    //             {referredTenants.map((tenant) => (\n    //               <MiniStat key={tenant} label=\"Tenant\" value={tenant} />\n    //             ))}\n    //           </div>\n    //         )}\n    //       </SectionCard>\n    //     </div>\n    //   </motion.section>\n    // </div>\n  );\n}\n\nfunction formatCurrency(amount: number) {\n  return new Intl.NumberFormat(\"en-US\", { style: \"currency\", currency: \"USD\" }).format(amount || 0);\n}"],"names":[],"mappings":";;;;;AAEA;AAKA;AAPA;;;;AASe,SAAS;IACtB,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,UAAU,EAAE,aAAa,EAAE,OAAO,EAAE,aAAa,EAAE,GAAG,IAAA,gOAA4B;IAEvG,MAAM,iBAAiB;QACrB,CAAC,iBAAiB,EAAE,cAAc,6BAA6B,CAAC;QAChE,GAAG,MAAM,SAAS,CAAC,cAAc,GAAG,oDAAoD,CAAC;QACzF,GAAG,eAAe,MAAM,UAAU,EAAE,2DAA2D,CAAC;KACjG;IAED,MAAM,eAAe,IAAA,sXAAO,EAC1B,IAAM;YACJ;gBACE,OAAO;gBACP,OAAO,eAAe,MAAM,iBAAiB;gBAC7C,aAAa,GAAG,WAAW,iBAAiB,CAAC;YAC/C;YACA;gBACE,OAAO;gBACP,OAAO,eAAe,MAAM,aAAa;gBACzC,aAAa;YACf;YACA;gBACE,OAAO;gBACP,OAAO,eAAe,MAAM,UAAU;gBACtC,aAAa;YACf;YACA;gBACE,OAAO;gBACP,OAAO,MAAM,SAAS,CAAC,cAAc;gBACrC,aAAa;YACf;SACD,EACD;QAAC;QAAY,MAAM,iBAAiB;QAAE,MAAM,UAAU;QAAE,MAAM,aAAa;QAAE,MAAM,SAAS;KAAC;IAG/F,MAAM,kBAAkB,MAAM,WAAW,EAAE;IAE3C,qBACE,oZAAC;kBAAI;;;;;;AAiGT;AAEA,SAAS,eAAe,MAAc;IACpC,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QAAE,OAAO;QAAY,UAAU;IAAM,GAAG,MAAM,CAAC,UAAU;AACjG","debugId":null}}]
}