{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","turbopack:///[project]/components/ui/skeleton.tsx","turbopack:///[project]/node_modules/next/navigation.js","turbopack:///[project]/utils/supplier-flow.ts","turbopack:///[project]/components/supplier-flow-guard.tsx","turbopack:///[project]/app/(dashboard)/dashboard/(supplier-flow)/layout.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","\"use client\";\nimport React from \"react\";\n\nexport function Skeleton({ className = \"\" }: { className?: string }) {\n  return <div className={`animate-pulse bg-gray-200 rounded ${className}`} />;\n}\n\nexport function TableSkeletonRows({ rows = 6, cols = 6 }: { rows?: number; cols?: number }) {\n  return (\n    <tbody>\n      {Array.from({ length: rows }).map((_, r) => (\n        <tr key={r} className=\"border-t\">\n          {Array.from({ length: cols }).map((__, c) => (\n            <td key={c} className=\"px-3 py-2\">\n              <Skeleton className=\"h-4 w-full\" />\n            </td>\n          ))}\n        </tr>\n      ))}\n    </tbody>\n  );\n}\n","module.exports = require('./dist/client/components/navigation')\n","import { SupplierOnboardingAPI } from './api';\n\nexport type SupplierFlowStatus = {\n  step: 'kyc_pending' | 'payment_pending' | 'approved' | 'rejected';\n  kyc_status?: string;\n  payment_status?: string;\n  can_access_dashboard: boolean;\n  next_action?: string;\n};\n\nexport async function getSupplierFlowStatus(): Promise<SupplierFlowStatus> {\n  try {\n    const [kycStatus, paymentStatus] = await Promise.all([\n      SupplierOnboardingAPI.getKYCStatus().catch(() => ({ status: 'not_submitted' })),\n      SupplierOnboardingAPI.getPaymentStatus().catch(() => ({ status: 'not_submitted' }))\n    ]);\n\n    // KYC not submitted or rejected\n    if (!kycStatus.status || kycStatus.status === 'not_submitted' || kycStatus.status === 'rejected') {\n      return {\n        step: 'kyc_pending',\n        kyc_status: kycStatus.status,\n        can_access_dashboard: false,\n        next_action: 'Submit KYC documents'\n      };\n    }\n\n    // KYC pending approval\n    if (kycStatus.status === 'pending') {\n      return {\n        step: 'kyc_pending',\n        kyc_status: kycStatus.status,\n        can_access_dashboard: false,\n        next_action: 'Wait for KYC approval'\n      };\n    }\n\n    // KYC approved, but payment not submitted or rejected\n    if (kycStatus.status === 'approved') {\n      if (!paymentStatus.status || paymentStatus.status === 'not_submitted' || paymentStatus.status === 'rejected') {\n        return {\n          step: 'payment_pending',\n          kyc_status: kycStatus.status,\n          payment_status: paymentStatus.status,\n          can_access_dashboard: false,\n          next_action: 'Submit payment verification'\n        };\n      }\n\n      // Payment pending approval\n      if (paymentStatus.status === 'pending') {\n        return {\n          step: 'payment_pending',\n          kyc_status: kycStatus.status,\n          payment_status: paymentStatus.status,\n          can_access_dashboard: false,\n          next_action: 'Wait for payment verification'\n        };\n      }\n\n      // Both approved - can access dashboard\n      if (paymentStatus.status === 'verified') {\n        return {\n          step: 'approved',\n          kyc_status: kycStatus.status,\n          payment_status: paymentStatus.status,\n          can_access_dashboard: true\n        };\n      }\n    }\n\n    // Default fallback\n    return {\n      step: 'kyc_pending',\n      can_access_dashboard: false,\n      next_action: 'Complete onboarding process'\n    };\n  } catch (error) {\n    console.error('Error checking supplier flow status:', error);\n    return {\n      step: 'kyc_pending',\n      can_access_dashboard: false,\n      next_action: 'Complete onboarding process'\n    };\n  }\n}\n\nexport function getRedirectPath(status: SupplierFlowStatus): string {\n  switch (status.step) {\n    case 'kyc_pending':\n      return '/dashboard/supplier-kyc';\n    case 'payment_pending':\n      return '/dashboard/supplier-payment';\n    case 'approved':\n      return '/dashboard/supplier';\n    default:\n      return '/dashboard/supplier-kyc';\n  }\n}","\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport { getSupplierFlowStatus, getRedirectPath } from \"@/utils/supplier-flow\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\ninterface SupplierFlowGuardProps {\n  children: React.ReactNode;\n}\n\nexport function SupplierFlowGuard({ children }: SupplierFlowGuardProps) {\n  const router = useRouter();\n  const pathname = usePathname();\n  const [loading, setLoading] = useState(true);\n  const [canAccess, setCanAccess] = useState(false);\n\n  useEffect(() => {\n    checkAccess();\n  }, [pathname]);\n\n  const checkAccess = async () => {\n    try {\n      setLoading(true);\n      const flowStatus = await getSupplierFlowStatus();\n      \n      // Define allowed paths for each step\n      const allowedPaths = {\n        kyc_pending: ['/dashboard/supplier-kyc'],\n        payment_pending: ['/dashboard/supplier-payment'],\n        approved: ['/dashboard/supplier']\n      };\n\n      const currentAllowedPaths = allowedPaths[flowStatus.step] || [];\n      \n      // Check if current path is allowed for current step\n      if (currentAllowedPaths.some(path => pathname.startsWith(path))) {\n        setCanAccess(true);\n      } else {\n        // Redirect to appropriate step\n        const redirectPath = getRedirectPath(flowStatus);\n        router.replace(redirectPath);\n      }\n    } catch (error) {\n      console.error('Error checking supplier flow:', error);\n      router.replace('/dashboard/supplier-kyc');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center space-y-4\">\n          <Skeleton className=\"h-8 w-64 mx-auto\" />\n          <Skeleton className=\"h-4 w-48 mx-auto\" />\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canAccess) {\n    return null;\n  }\n\n  return <>{children}</>;\n}","\"use client\";\n\nimport { SupplierFlowGuard } from \"@/components/supplier-flow-guard\";\n\nexport default function SupplierFlowLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <SupplierFlowGuard>\n      <div className=\"min-h-screen bg-gray-50\">\n        {/* <div className=\"container mx-auto px-4 py-8\"> */}\n          {children}\n        {/* </div> */}\n      </div>\n    </SupplierFlowGuard>\n  );\n}"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1,2,4]}